webpackJsonp([1],{346:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=o(175),a=o(2),n=o(177),i=o(14),l=o(7),s=o(1),c=o(174),h=o(3),d=[{initialAttr:function(){return{opacity:0}},finalAttr:function(){return{opacity:1}}}],g={"initial.dataset.entities":function(){return{"path.appearing":()=>(d[0].slot="plot",d),"path.updating":e=>[{finalAttr:function(){return e.finalAttr}}],"labelConnectors.appearing":()=>(d[0].slot="final",d),"labelConnectors.updating":null,"entityLabel.appearing":()=>[{initialAttr:{opacity:0},finalAttr:{opacity:1},slot:"final"}],"*":null}},"initial.dataset.markers":function(){return{markers:null,"markerItem.appearing":()=>(d[0].slot="final",d),"markerItem.updating":e=>[{finalAttr:function(){return e.finalAttr}}]}},"initial.group.mapGroup":function(){return{"group.appearing":e=>[{initialAttr:function(){return Object.assign({opacity:0},e.attr)},finalAttr:function(){return e.attr},slot:"plot"}],"group.updating":e=>[{initialAttr:function(){return Object.assign({opacity:0},e.attr)},finalAttr:function(){return e.attr},slot:"plot"}],"*":null}}},p=o(8);let u,f=Object(h.b)("redraphael","plugin"),m=window.navigator.userAgent,b=/msie/i.test(m)&&!window.opera,v=",",y="",C="top",_="bottom",x="right",O="left",k="middle",w="center",F="crisp",j=window.Math,A=j.min,L=j.max,S=/stroke/gi,E=/AppleWebKit/.test(m),I=j.ceil,P=function(e,t){let o=t?Object(s._0)(e.FCcolor,t,!1,!0):{FCcolor:e};return o.toString=s._53,o},T=function(e,t){let o,r={};if(t=t||1,!e||"object"!=typeof e)return r;for(o in e)S.test(o)||("stroke-width"===o?(r[o]=+e[o]/t,E&&(r[o]=r[o]&&I(r[o])||0)):r[o]=e[o]);return r},R={right:function(){return arguments[1]},left:function(e,t){return e-t},center:function(e,t){return 2*A(t,e-t)}},M={top:function(){return arguments[1]},middle:function(e,t){return 2*A(t,e-t)},bottom:function(e,t){return e-t}},B=function(e){let t,o=e&&e.length||0,r={};for(;o--;)(t=e[o]).id!==u&&(r[t.id.toLowerCase()]=t);return r};var D,V,N,G,H,W,z,X,K,Y,U;Object(h.a)({name:"mapsAnimation",type:"animationRule",extension:g}),D=f,H=window.parseFloat,W=D._createNode,z=D._setFillAndStroke,X=D.el.constructor,K={Q:"L",Z:"X",q:"l",z:"x",",":" "},Y=/,?([achlmqrstvxz]),?/gi,U=function(){return this.join(",").replace(Y,V)},D.svg?(V="$1",N=function(){var e=D.is(arguments[0],"array")?arguments[0]:Array.prototype.slice.call(arguments);e?"string"==typeof e?e=e.replace(Y,V):e.toString=U:e="M0,0",this.node.setAttribute("d",e.toString())},D._engine.litepath=function(e,t,o,r,a){var n,i=W("path");return(r||t).canvas.appendChild(i),(n=new X(i,t,r)).type="litepath",n.id=i.raphaelid=D._oid++,i.raphael=!0,z(n,a||{fill:"none",stroke:"#000"}),n},D._getPath.litepath=function(e){return D.parsePathString(e.node.getAttribute("d"))}):D.vml&&(V=function(e,t){return K[t]||t},G=function(){var e=this;return e._transform.apply(e,arguments),e._.bcoord&&(e.node.coordsize=e._.bcoord),e},N=function(e){return e?"string"==typeof e?e=e.replace(Y,V):e.toString=U:e="M0,0",this.node.path=e,this},D._engine.litepath=function(e,t,o,r,a){var n,i=W("shape"),l=i.style,s=new X(i,t,r);return l.cssText="position:absolute;left:0;top:0;width:21600px;height:21600px;",o=H(o),isNaN(o)?i.coordsize="21600 21600":(s._.bzoom=o,l.width="1px",l.height="1px",i.coordsize=s._.bcoord=o+" "+o),i.coordorigin=t.coordorigin,s.type="litepath",s.id=i.raphaelid=D._oid++,i.raphael=!0,s._transform=s.transform,s.transform=G,D._setFillAndStroke(s,a||{fill:"none",stroke:"#000"}),(r||t).canvas.appendChild(i),(n=W("skew")).on=!0,i.appendChild(n),s.skew=n,s},D._getPath.litepath=function(e){return D.parsePathString(e.node.path||"")}),D.fn.litepath=function(e,t,o){var r,a,n;return"object"==typeof e&&e.constructor!==X&&(r=e,a=(e=e.litepath).zoom,o=e.group),t&&t.constructor===X?(o=t,a=void 0):a=t,e&&e.constructor===X&&(o=e,e=""),(n=D._engine.litepath(e,this,a,o,r)).ca.litepath=N,e&&n.attr("litepath",D.is(e,"array")?[e]:e),this.__set__&&this.__set__.push(n),this._elementsById[n.id]=n};class J extends a.a{constructor(){super(),this.components={}}getName(){return"entities"}getType(){return"dataset"}configureAttributes(e){if(!e)return;this.JSONData={data:e};let t,o,r,a,n,i,l,c,h=this,d=h.getFromEnv("chart").jsonData,g=h.config,p=d.map||d.chart,u=[],f=h.getFromEnv("colorManager"),m=d.entitydef||[];for(n in!g.attachEvent&&f&&(h.addExtEventListener("legendUpdate",function(){if("legend"===(c=arguments[1]).component)h.legendInteractivity(c.legendItem,c.colorObj);else for(u=c.maxMinArray,i=u.length,l=0;l<i;l++)h.updateEntityColors(u[l].min,u[l].max)},f),g.attachEvent=!0),t=d.data&&d.data[0]&&d.data[0].data?h.JSONData=d.data[0].data||[]:h.JSONData=d.data||[],g.useSNameAsId=Object(s._40)(p.usesnameasid,0),this._redefineEntities(m),o=h.components.data,g.showTooltip=Object(s._40)(p.showtooltip,1),g.showHoverEffect=Object(s._40)(p.showhovereffect,0),t=B(t),h.calculateDataLimits(),d.colorrange||h.detachChild(h.getChildren("colorRange")&&h.getChildren("colorRange")[0].getId()),o)r=t[n],a=o[n],r?this._configureEntity(n,a,Object(s._27)(J._sanitizeEntityOptions(Object(s._0)({},r)),a.config)):this._configureEntity(n,a,a.config)}updateEntityColors(e,t){let o,r,a,n,i,l,s=this.components.data,c=this.getFromEnv("chart"),h={"fill-opacity":0};for(n in s)a=(r=(o=s[n]).config).cleanValue,l={"fill-opacity":(i=r.alphaArr||[])[0]/100||1},a<e||a>t?(J.setCustomAttrs(o,h,c),o.hidden=!0):(o.hidden=!1,J.setCustomAttrs(o,l,c))}legendInteractivity(e,t){let o,r,a,n,i,l,s=this,c=s.getFromEnv("chart"),h=s.components.data,d=e.config,g=e.hasState("hidden"),p=s.getFromEnv("colorManager"),u={},f={"fill-opacity":0};for(o in c.getFromEnv("animationManager").setAnimationState("legendInteraction"),h)h.hasOwnProperty(o)&&(a=(d=(r=h[o]).config).cleanValue,l=p.getColorObj(a),n=d.visibleEntityAttr,u["fill-opacity"]=n["fill-opacity"],i=g?u:f,t.code===(!l.outOfRange&&l.code)&&(r.hidden=!g,J.setCustomAttrs(r,i,c),g?e&&e.removeLegendState("hidden"):e.setLegendState("hidden")))}static setCustomAttrs(e,t){let o,r;e&&(r=(o=e.graphics).outlines).attr(t)}calculateDataLimits(){let e,t,o,r,a=this.getFromEnv("chart"),n=this.config,i=a.jsonData.data||[],l=this.getFromEnv("number-formatter"),s=1/0,c=-1/0;for(r=0,o=i.length;r<o;r++)t=i[r].value,e=l.getCleanValue(t),s=A(s,e),c=L(c,e);n.max=c,n.min=s}_configureEntity(e,t,o){let r,a,n,i,l,c,h,d,g,p,f,m,b,C,_,x,O,F,j,A,L,S,E=this,I=E.getFromEnv("chart"),T=E.config,R=this.getFromEnv("number-formatter"),M=I.config.entityOpts,B=t.config,D=t.labelConfig,V=o.value,N=B.cleanValue=R.getCleanValue(V),G=B.formattedValue=N===u?u:R.dataLabels(N),H=Object(s._40)(o.showtooltip,M.showTooltip),W=this._getDefaultTooltip(t,o,E),z={formattedValue:G,sName:o.shortLabel,lName:o.label},X=M.dataLabels.style,K=B.toolText=H?Object(s._37)(Object(s._38)(Object(s._36)(Object(s._38)(o.tooltext,M.tooltext,W),[1,2,7,38,39],z,o))):y,Y=B.borderColor=Object(s._38)(o.bordercolor,M.borderColor),U=B.borderAlpha=Object(s._38)(o.borderalpha,M.borderAlpha),J=B.borderThickness=Object(s._40)(o.borderthickness,M.borderThickness),Q=M.hoverOnNull,Z=B.useHoverColor=Object(s._40)(o.showhovereffect,o.usehovercolor,Q?M.showHoverEffect:isNaN(V)?0:M.showHoverEffect),q=B.labelAlignment,$=E.getFromEnv("colorManager");if(t.hidden=!1,B.showLabel=Object(s._40)(o.showlabel,M.showLabels),B.labelPadding=Object(s._40)(o.labelpadding,M.labelPadding),B.fontFamily=Object(s._38)(o.font,X.fontFamily),B.fontSize=Object(s._40)(parseInt(o.fontsize,10),parseInt(X.fontSize,10)),B.fontBold=Object(s._40)(o.fontbold,0),B.fontColor=Object(s._38)(o.fontcolor,X.color),B.connectorColor=Object(s._38)(o.labelconnectorcolor,M.connectorColor),B.connectorAlpha=Object(s._38)(o.labelconnectoralpha,M.connectorAlpha),B.hoverBorderThickness=Object(s._40)(o.borderhoverthickness,o.hoverborderthickness,M.hoverBorderThickness),B.hoverBorderColor=Object(s._38)(o.borderhovercolor,o.hoverbordercolor,M.hoverBorderColor,B.borderColor),B.hoverBorderAlpha=Object(s._38)(o.borderhoveralpha,o.hoverborderalpha,M.hoverBorderAlpha,B.borderAlpha),B.connectorThickness=Object(s._40)(o.labelconnectorthickness,M.connectorThickness),B.origConnectorThickness=B.connectorThickness,B.borderThickness=J,B.link=o.link,B.isVisible=!0,B.id=e,B.originalId=o.origId,null!==N&&((r=$&&$.getColor(N))&&!r.outOfRange&&(x=r.code,r.oriAlpha!==u&&(O=r.oriAlpha+""))),Object(s._38)(o.color,o.alpha,o.angle,o.ratio)===u?(C=P({color:Object(s._38)(x,M.fillColor),alpha:Object(s._38)(O,M.fillAlpha),angle:Object(s._38)(M.fillAngle),ratio:Object(s._38)(M.fillRatio)}),b=P({color:Object(s._38)(M.nullEntityColor),alpha:Object(s._38)(M.nullEntityAlpha),angle:Object(s._38)(M.nullEntityAngle),ratio:Object(s._38)(M.nullEntityRatio)}),l=(g=null===N?b:C).FCcolor.color,c=g.FCcolor.alpha,h=g.FCcolor.angle,d=g.FCcolor.ratio):(l=Object(s._38)(o.color,x,M.fillColor),c=Object(s._38)(o.alpha,O,M.fillAlpha),h=Object(s._38)(o.angle,M.fillAngle),d=Object(s._38)(o.ratio,M.fillRatio),g=P({color:l,alpha:c,angle:h,ratio:d})),K===y&&(T.showTooltip=0),B.visibleEntityAttr={stroke:Object(s.R)(Y,U),fill:(B.fillColor=g).toString(),"fill-opacity":c/100},S=c.split(v),B.alphaArr=S,Z&&(Object(s._38)(o.fillhovercolor,o.fillhoveralpha,o.fillhoverangle,o.fillhoverratio,o.hoverfillcolor,o.hoverfillalpha,o.hoverfillratio,o.hoverfillangle)===u?(!M.hoverColorObject&&(M.hoverColorObject=P({color:M.hoverFillColor,alpha:M.hoverFillAlpha,angle:M.hoverFillAngle,ratio:M.hoverFillRatio})),_=M.hoverColorObject):(l=Object(s._38)(o.fillhovercolor,o.hoverfillcolor,M.hoverFillColor),c=Object(s._38)(o.fillhoveralpha,o.hoverfillalpha,M.hoverFillAlpha),h=Object(s._38)(o.fillhoverangle,o.hoverfillangle,M.hoverFillAngle),d=Object(s._38)(o.fillhoverratio,o.hoverfillratio,M.hoverFillRatio),_=P({color:l,alpha:c,angle:h,ratio:d})),B.hoverColor=_),D||(D=t.labelConfig={}),p=B.fontColor,f=B.fontFamily,m=B.fontBold,K=B.toolText,a=B.link,q?(n=q[0],i=q[1]):(n=w,i=k),D.align=n,D.vAlign=i,D.bgColor=y,D.borderColor=y,D.fontColor=p,D.fontFamily=f,D.fontBold=m,D.toolText=K,D.link=a,"object"==typeof B.options)for(F=B.entityLabels=B.entityLabels||[],L=(A=B.labels||[]).length;L--;)F[L]||(F[L]={config:{}}),D=F[L].config,(q=A[L].labelAlignment)?(n=q[0],i=q[1]):(n=w,i=k),D.align=n,D.vAlign=i,D.displayValue=E.getDisplayValue(t,A[L],B.options.isDataEnabled,!L,o),D.bgColor=y,D.borderColor=y,D.toolText=K,D.align=n,D.vAlign=i,D.bgColor=y,D.borderColor=y,D.fontColor=p,D.fontFamily=f,D.fontBold=m,D.toolText=K;else j={shortText:B.shortLabel,text:B.label},D.displayValue=E.getDisplayValue(t,j,!0,!0,o)}getDisplayValue(e,t,o,r,a){let n,i=this.getFromEnv("chart").config.entityOpts,l=e.config,c=l.cleanValue,h=l.formattedValue,d=i.labelSepChar;return o?r&&void 0!==a.displayvalue?n=a.displayvalue:(n=Object(s._38)(i.includeNameInLabels?i.useShortName?t.shortText:t.text:""),i.includeValueInLabels&&null!==c&&(n=n===u?h:n+d+h)):n=l.label,n}static _sanitizeEntityOptions(e){return delete e.outlines,delete e.label,delete e.shortlabel,delete e.labelposition,delete e.labelalignment,delete e.labelconnectors,e}_redefineEntities(e){let t,o,r,a,n,i,l,c,h,d,g,p,u=this,f=u.config,m={},b={},v=u.getFromEnv("chart").config.entities,y=f.useSNameAsId,C=0;for(t=e.length;t--;)if(r=(o=e[t]).internalid,a=o.newid?o.newid:r,n=o.sname,i=o.lname,p=v[r],r=Object(s._55)(r),a=(a=Object(s._55)(a))&&a.toLowerCase(),p){for(g in m[a]=c={origId:r},b[r]=!0,p)c[g]=p[g];c.shortLabel=n||p.shortLabel,c.label=i||p.label,c.showhovereffect=o.showhovereffect,c.fillhovercolor=o.fillhovercolor,c.fillhoveralpha=o.fillhoveralpha,c.fillhoverangle=o.fillhoverangle,c.fillhoverratio=o.fillhoverratio,c.borderhoverthickness=o.borderhoverthickness}for(l in(d=u.components.data)||(d=u.components.data={}),m)d[l=l.toLowerCase()]||(d[l]={config:{}}),d[l].config=m[l],C+=1;for(l in h=d,v)if(c=v[l],!b[l=Object(s._55)(l)]){for(g in y?(!(p=h[c.shortLabel.toLowerCase()])&&(p=h[c.shortLabel.toLowerCase()]={}),p.config={},p.origId=c.shortLabel):(!(p=h[l.toLowerCase()])&&(p=h[l.toLowerCase()]={}),p.config={},p.config.origId=l),c)p.config[g]=c[g];C+=1}f.entityCount=C}draw(){let e,t=this,o=t.config,r=t.getFromEnv("chart"),a=s._23?200:10;t.createContainer(),this.config.ready=!1,o.BATCH_SIZE=a,o.labelBatchSize=s._23?200:20,(e=this._batchRender())(0),r.config.entityFlag=!0,r.checkComplete()}_batchRender(){let e,t,o,r,a,n=this,i=n.config,l=n.getFromEnv("chart").config.entities.firstEntity,s=n.components.data,c=i.BATCH_SIZE,h=i.entityKeys=l?n._getKeys(l,s):Object.keys(s),d=i.entityLength=h.length,g=function(i){for(e=i,o=0;h[e]!==u;)if(t=s[h[e]],a=n.drawEntity(t,c),o+=a,t.config.drawn&&((r=e===d-1?t:s[h[e-1]])&&(r.config.drawn=!1,r.config.outlineStartIndex=u),e++),o>=c){n.addJob("entityDraw",g.bind(this,e),p.b.entitydraw);break}e===d&&(n._addEventListenersToEntities(0),n.initComplete())};return g}_addEventListenersToEntities(e){let t,o,r,a,n=this,i=n.components.data,l=n.config,s=l.BATCH_SIZE,c=l.entityKeys,h=l.entityLength,d=0;for(t=e;t<h;t++)if((r=(a=(o=i[c[t]]).config).options)&&!1===r.isDataEnabled||n.addMouseGestures(o),++d===s){n.addJob("_addEventListenersToEntities",n._addEventListenersToEntities.bind(this,t),p.b.entitydraw);break}}static _getKeys(e,t){let o=[e],r=e;for(;t[r];)r=t[r].nextId,o.push(r);return o}_getDefaultTooltip(e,t){let o,r,a=e.config.cleanValue,n=e.config.formattedValue,i=this.getFromEnv("chart").config.entityOpts;if("object"==typeof e.config.options){if(!(r=t.labels&&t.labels[0]))return u;o=(i.useSNameInTooltip?r.shortText:r.text)+(null===a?y:i.tooltipSepChar+n)}else o=(i.useSNameInTooltip?t.shortLabel:t.label)+(null===a?y:i.tooltipSepChar+n);return o}drawEntity(e,t){let o,r,a,n,i,l,c,h,d,g=this,p=g.getFromEnv("chart"),f=p.getFromEnv("animationManager"),m=e.config,v=s._23||!b?"litepath":"path",y=p.config.entityOpts,C=m.outlines,_=g.getFromEnv("toolTipController"),x=this.getLinkedParent().getChildContainer("plot"),O=this.getLinkedParent().getChildContainer("plotShadow"),k=m.toolText,w=y.shadow,F=[],j={};if(g._configureEntityDrawingParams(e),a=(m=e.config).visibleEntityAttr,d=m.shadowOptions,o=m.outlineStartIndex===u?C.length:m.outlineStartIndex,e.graphics||(e.graphics={}),c=0,F=m.outlinePath||(m.outlinePath=[]),h=m.customStrokeWidthModifier,"object"==typeof m.options){for(;o--;)if(F=C[o].outline,n=!0===m.options.isDataEnabled?a:Object(s._0)(Object(s._0)({},a),T(C[o].style,h)),(i=e.graphics.outlines)||(i=e.graphics.outlines=[]),i[o]||(i[o]={}),l=i[o].outline,n[v]=F,(l=i[o].outline=f.setAnimation({el:v,container:x,attr:n,component:g,label:"path"})).shadow(!!w&&d,O),_.enableToolTip(l,k),c++,m.outlineStartIndex=o,c===t)return c;return m.drawn=!0,c}for(;o--;)if(F=(r=C[o]).concat(F),c++,m.outlineStartIndex=o,c===t)return m.outlinePath=F,c;return e.graphics.outlines||(a[v]=F),Object.assign(j,a,e.hidden&&{"fill-opacity":0}||{}),e.graphics.outlines=f.setAnimation({el:e.graphics.outlines||v,container:x,attr:j,component:g,label:"path"}),m.drawn=!0,m.outlineStartIndex=0,m.outlinePath=[],e.graphics.outlines.shadow(!!w&&d,O),_.enableToolTip(e.graphics.outlines,k),c}_configureEntityDrawingParams(e){let t,o=this.getFromEnv("chart"),r=e.config,a=o.config.entityOpts,n=o.config.scalingParams,i=!b||s._23,l=n.scaleFactor,c=n.strokeWidth,h=(i?o.baseScaleFactor:1)*c,d=1===a.scaleBorder,g=r.borderThickness,p=r.alphaArr,u=r.origConnectorThickness,f=r.hoverBorderThickness,m=r.visibleEntityAttr,v=m["fill-opacity"];r.shadowOptions={scalefactor:[l,l*o.config.baseScaleFactor],opacity:L.apply(j,p)/100,useFilter:0},r.fillOpacity=e.hidden?0:v,i?(g=r.entityBorderThickness=d?g*h:g/l,u/=l,t=d?l:n.sFactor,f&&(f=r.hoverBorderThickness=d?f*h:f/l)):(g=d?g*c:g,t=d?n.scaleFactor:o.baseScaleFactor),r.entityBorderThickness=g,r.connectorThickness=u,r.customStrokeWidthModifier=t,m["stroke-width"]=g,m.transform=s._23||!b?"":n.transformStr}drawLabels(e){let t,o,r,a,n=this,i=e,l=n.getFromEnv("chart"),s=n.config,h=s.labelBatchSize,d=s.entityLength,g=[],p=l.getChildContainer("upperAnnotationGroup"),u=0,f=n.getChildren("mapLabelAnnotations")&&n.getChildren("mapLabelAnnotations")[u],m=0,b=0,v=l.config.annotationConfig;for(t in f||(a=new c.a,n.attachChild(a,"mapLabelAnnotations"),(f=n.getChildren("mapLabelAnnotations")[u]).addCustomGroup(p)),f.destroy(),f._renderer&&(f._renderer=null),v.showbelow=0,i){if(n.drawLabel(i[t],g),++m===h){for(o=0;o<g.length;o++)g[o].animationLabel="entityLabel";for(r=f.addGroup(Object.assign(v,{id:"entityLabels"+u,items:g,animationLabel:"entityLabelGroup"}),n),o=0;o<r.items.length;o++)r.items[o].addEventListener("fc-mouseover",g[o].onmouseover),r.items[o].addEventListener("fc-mouseout",g[o].onmouseout),r.items[o].addEventListener("fc-click",g[o].onclick);u++,(f=n.getChildren("mapLabelAnnotations")&&n.getChildren("mapLabelAnnotations")[u])||(a=new c.a,n.attachChild(a,"mapLabelAnnotations"),(f=n.getChildren("mapLabelAnnotations")[u]).addCustomGroup(p)),f.destroy(),f._renderer&&(f._renderer=null),m=0,g=[]}else if(b==d-1){for(o=0;o<g.length;o++)g[o].animationLabel="entityLabel";for(r=f.addGroup(Object.assign(v,{id:"entityLabels"+u,items:g,animationLabel:"entityLabelGroup"}),n),o=0;o<r.items.length;o++)r.items[o].addEventListener("fc-mouseover",g[o].onmouseover),r.items[o].addEventListener("fc-mouseout",g[o].onmouseout),r.items[o].addEventListener("fc-click",g[o].onclick)}b++}n.drawLabelConnFn(0)}drawLabelConnFn(e){let t,o,r,a,n,i=this,l=i.config,s=i.components.data,c=l.BATCH_SIZE,h=l.entityKeys,d=h.length,g=0;for(o=e;o<d;o++){if("object"==typeof(a=(n=s[h[o]]).config).options)for(t=(r=a.labels)&&r.length||0;t--;)r[t].labelConnectors&&(i.drawLabelConnectors(n,r[t].labelConnectors,i),g++);else a.labelConnectors&&(i.drawLabelConnectors(n,a.labelConnectors,i),g++);if(g===c){i.addJob("drawLabelConnectors",i.drawLabelConnFn.bind(this,o),p.b.entitydraw);break}}}_getLabelObject(e,t,o){let r,a,n,i,l,s,c,h,d,g,p,f,m=this,b=m.getFromEnv("chart"),v=e.config,y=b.config.scalingParams,F=e.graphics&&e.graphics.outlines,j=v.fontSize,A=v.labelPadding,L=v.labels||[],S=v.entityLabels||[];return t===u?(r=e.labelConfig,a=v.labelPosition,n=v.labelAlignment):(p=L[t],i=(r=(f=S[t]).config).style=p.style,a=p.labelPosition,n=p.labelAlignment),a?(l=a[0],s=a[1]):(l=(c=F.getBBox()).x+c.width/2,s=c.y+c.height/2),n?(h=n[0],d=n[1],h===x?l-=A:h===O&&(l+=A),d===C?s-=A:d===_&&(s+=A)):(h=w,d=k),g=parseFloat(j)/y.sFactor,!o&&i&&(i.color&&(r.fontColor=i.color),i["font-size"]&&(g=parseFloat(i["font-size"])/y.sFactor),i["font-family"]&&(r.fontFamily=i["font-family"]),i["font-weight"]!==u&&(r.fontBold="bold"===i["font-weight"])),r.x=l.toString(),r.y=s.toString(),r.wrap=1,r.type="text",r.fontSize=g,{x:l.toString(),y:s.toString(),wrapwidth:R[h](void 0,l+void 0)-A,wrapheight:M[d](void 0,s+void 0)-A,wrap:1,type:"text",align:r.align,valign:r.vAlign,text:r.displayValue,tooltext:r.toolText,css:r.link!==u&&{cursor:"pointer",_cursor:"hand"},bgcolor:r.bgColor,bordercolor:r.borderColor,fillcolor:r.fontColor,fontsize:r.fontSize,font:r.fontFamily,bold:r.fontBold,onclick:function(t){let o,r,a=e.graphics.outlines;if(a instanceof Array)for(o=0,r=a.length;o<r;o++)m.entityClick(a[o].outline,t);else m.entityClick(a,t)},onmouseover:function(t){let o,r,a=e.graphics.outlines;if(a instanceof Array)for(o=0,r=a.length;o<r;o++)m.entityRollOver(a[o].outline,t);else m.entityRollOver(a,t)},onmouseout:function(t){let o,r,a=e.graphics.outlines;if(a instanceof Array)for(o=0,r=a.length;o<r;o++)m.entityRollOut(a[o].outline,t);else m.entityRollOut(a,t)},ontouchstart:function(t){let o,r,a=e.graphics.outlines;if(a instanceof Array)for(o=0,r=a.length;o<r;o++)m.entityRollOver(a[o].outline,t);else m.entityRollOver(a,t);m.entityRollOver(a,t)}}}drawLabel(e,t){let o,r,a,n=this,i=e.config;if(i.showLabel)if("object"==typeof i.options)for(r=(a=i.labels)&&a.length||0,o=i.options.isDataEnabled;r--;)t.push(n._getLabelObject(e,r,o,!r));else t.push(n._getLabelObject(e,u,!0,!0))}drawLabelConnectors(e,t,o){let r,a,n=e.config,i=this,l=i.getFromEnv("chart"),c=l.getFromEnv("animationManager"),h=l.config.scalingParams,d=o.getLinkedParent().getChildContainer("plot"),g=t&&t.length||0,p=n.showLabel;for(;g--;)a=t[g],r=e.graphics.connectorElem,p?e.graphics.connectorElem=r=c.setAnimation({el:e.graphics.connectorElem||"path",attr:{path:a,opacity:1,transform:s._23||!b?"":h.transformStr,stroke:Object(s.R)(n.connectorColor,n.connectorAlpha),"shape-rendering":F,"stroke-width":n.connectorThickness},container:d,component:i,label:"labelConnectors"}):r&&r.hide()}entityClick(e,t){let o=e.node.__entity,r=this.getFromEnv("chart"),a=r.config.scalingParams,n=e.getBBox(),i=r.getFromEnv("linkClickFN"),l=o.config,s=l.link;n.width*=a.scaleFactor,n.height*=a.scaleFactor,n.x=n.x*a.scaleFactor+a.translateX,n.y=n.y*a.scaleFactor+a.translateY,n.x2=n.x+n.width,n.y2=n.y+n.height,r.fireChartInstanceEvent("entityclick",l.eventArgs,t),s!==u&&i.call({link:s,entity:o,entityBox:n},!0)}entityRollOver(e,t){let o=e.node.__entity,r=o.config,a=this.getFromEnv("chart"),n=a.getFromEnv("animationManager"),i=r.hoverAttr;a.plotEventHandler(e,t,"entityRollOver"),e.data("hovered")?clearTimeout(o.config.timer):r.useHoverColor&&r.isVisible&&!o.hidden&&i&&(a.config.hoverEntity=e,n.setAnimation({el:e,attr:i,component:this,state:"updating",label:"path"}),e.data("hovered",!0))}entityRollOut(e,t){let o,r=e.node.__entity,a=this,n=a.getFromEnv("chart"),i=n.getFromEnv("animationManager"),l=r.config.revertAttr;n.plotEventHandler(e,t,"entityRollOut"),r.config.timer=setTimeout(function(){!0!==(o=r.hidden)&&l&&(i.setAnimation({el:e,attr:l,component:a,state:"updating",label:"path"}),e.data("hovered",!1))},100)}addMouseGestures(e){let t,o,r,a,n,i=e.config,l=i.originalId,c=this,h=e.graphics,d=i.useHoverColor,g=i.hoverBorderThickness,p=i.hoverBorderColor,f=i.hoverBorderAlpha,m=i.entityBorderThickness,b=i.borderColor,v=i.borderAlpha,y=i.link,C=i.visibleEntityAttr,_=function(t){y!==u&&t.css({cursor:"pointer",_cursor:"hand"}),t.data("eventArgs",i.eventArgs),t.data("groupId","groupId"+l),t.node.__entity=e,e._listenersBinded||t.on("fc-click",c.entityClick.bind(c,t)).hover(c.entityRollOver.bind(c,t),c.entityRollOut.bind(c,t))};for(t in i.eventArgs={value:i.cleanValue,label:i.label,shortLabel:i.shortLabel,originalId:i.origId,id:i.id||i.origId},i.legacyEventArgs={value:i.value,lName:i.label,sName:i.shortLabel,id:i.originalId||i.id},d&&(i.hoverAttr={fill:Object(s._53)(i.hoverColor)},i.revertAttr={fill:Object(s._53)(i.fillColor),stroke:Object(s._53)(i.borderColor,i.borderAlpha)},i.revertAttr["fill-opacity"]=C["fill-opacity"],g!==m&&(i.hoverAttr["stroke-width"]=Object(s._40)(g,m),i.revertAttr["stroke-width"]=m),(p!==b||f!==v)&&(i.hoverAttr.stroke=Object(s.R)(p,f),i.revertAttr.stroke=Object(s.R)(b,v))),h)if(h.hasOwnProperty(t))if(h[t]instanceof Array){for(o=0,a=(n=h[t]).length;o<a;o++)_(r=n[o].outline);e._listenersBinded=!0}else _(r=h[t]),e._listenersBinded=!0}getDataLimits(){let e=this.config;return{max:e.max,min:e.min}}createContainer(){let e=this,t=e.getLinkedParent(),o=e.getFromEnv("animationManager"),r=t.getChildContainer("layer0");e.getChildContainer("abovePlotGroup")||e.addChildContainer("abovePlotGroup",o.setAnimation({el:"group",attr:{name:"abovePlotGroup",opacity:1},container:r,component:e,label:"group"})),e.getChildContainer("belowPlotGroup")||e.addChildContainer("belowPlotGroup",o.setAnimation({el:"group",attr:{name:"belowPlotGroup",opacity:1},container:r,component:e,label:"group"}))}initComplete(){let e=this.getFromEnv("chart"),t=this.components.data;this.drawLabels(t),e.config.entitiesReady=!0,e.checkComplete()}}var Q,Z=J,q=function(e,t,o,r,a){var n=Math.pow;return n(o-e,2)+n(r-t,2)<=n(a,2)},$=Math.PI,ee=Math.cos,te=Math.sin,oe=Math.max,re=Math.min,ae=$/180,ne=function(e,t,o,r,a,n){var i,l,s;return i=(r-t)*(a-o),l=(o-e)*(n-r),isNaN(i)&&(i=0),isNaN(l)&&(l=0),0===(s=i-l)?0:0<s?1:2},ie=function(e,t,o,r,a,n){return!!(o<=oe(e,a)&&o>=re(e,a)&&r<=oe(t,n)&&r>=re(t,n))},le=function(e,t,o,r,a,n,i,l){var s=ne(e,t,o,r,a,n),c=ne(e,t,o,r,i,l),h=ne(a,n,i,l,e,t),d=ne(a,n,i,l,o,r);return!!(s!==c&&h!==d||0===s&&ie(e,t,a,n,o,r)||0===c&&ie(e,t,i,l,o,r)||0===h&&ie(a,n,e,t,i,l)||0===d&&ie(a,n,o,r,i,l))},se=function(e,t,o,r,a,n,i){var l,s,c,h,d,g,p,u=0,f=!1;if(q(e,t,o,r,a)&&3<=n){for(s=i===Q?.5*$:function(e){return e%360*ae}(i),p=2*$/n,c=o+a*ee(-s),g=r+a*te(-s),l=0;l<n;l++){if(h=o+a*ee(-(s+=p)),d=r+a*te(-s),le(c,g,h,d,e,t,1/0,t)){if(0===ne(c,g,e,t,h,d))return ie(c,g,e,t,h,d);u++}c=h,g=d}f=0!=u%2}return f},ce=(e,t)=>!e||e&&t&&t.i>e.i?t:e;class he{constructor(e){this.configure(e)}configure(e){var t=this;t.validatorFn=e?t.shapeValidator():t.defaultValidator()}defaultValidator(){var e=Math.pow,t=this;return function(o){var r=t.mousePoint;return!!(o&&1>=e((o.x-r.x)/t.xLimit,2)+e((o.y-r.y)/t.yLimit,2))}}shapeValidator(){var e=this;return function(t){var o,r,a,n,i,l,s,c,h,d=e.mousePoint,g=t&&t.shapeInfo,p=!1,u=d.x,f=d.y;return"circle"===(o=g&&g.type)?(a=g.radius,p=q(u,f,t.x,t.y,a)):"arc"===o?(r=g.innerradius,a=g.radius,p=!q(u,f,t.x,t.y,r)&&q(u,f,t.x,t.y,a)):"polygon"===o?(a=g.radius,i=g.startAngle,n=g.sides,p=se(u,f,t.x,t.y,a,n,i)):"rect"===o||"rectangle"===o?(l=t.x,c=t.y,s=l+(g.width||0),h=c+(g.height||0),p=u>=l&&u<=s&&f>=c&&f<=h):"default"===o&&(p=!1),p}}buildKdTree(e){return this.kdTree=function(e){function t(e,t,o){var r=e[t];e[t]=e[o],e[o]=r}var o,r,a,n=e&&e[0]&&e[0].r||5,i=Math.max,l=Math.floor,s=Math.sqrt,c=Math.min,h=Math.log,d=Math.exp,g=Math.pow;for(r=function(e,o,a,n){for(var g,p,u,f,m,b,v,y,C,_;n>a;){for(600<n-a&&(p=o-a+1,u=h(g=n-a+1),f=.5*d(2*u/3),m=.5*s(u*f*(g-f)/g)*(0>p-g/2?-1:1),b=i(a,l(o-p*f/g+m)),v=c(n,l(o+(g-p)*f/g+m)),r(e,o,b,v)),y=e[o],C=a,_=n,t(e,a,o),e[n].x>y.x&&t(e,a,n);C<_;){for(t(e,C,_),C++,_--;e[C].x<y.x;)C++;for(;e[_].x>y.x;)_--}e[a].x===y.x?t(e,a,_):t(e,++_,n),_<=o&&(a=_+1),o<=_&&(n=_-1)}},a=function(e,o,r,n){for(var g,p,u,f,m,b,v,y,C,_;n>r;){for(600<n-r&&(p=o-r+1,u=h(g=n-r+1),f=.5*d(2*u/3),m=.5*s(u*f*(g-f)/g)*(0>p-g/2?-1:1),b=i(r,l(o-p*f/g+m)),v=c(n,l(o+(g-p)*f/g+m)),a(e,o,b,v)),y=e[o],C=r,_=n,t(e,r,o),e[n].y>y.y&&t(e,r,n);C<_;){for(t(e,C,_),C++,_--;e[C].y<y.y;)C++;for(;e[_].y>y.y;)_--}e[r].y===y.y?t(e,r,_):t(e,++_,n),_<=o&&(r=_+1),o<=_&&(n=_-1)}},o=(e=e||[]).length;o--;)e[o].r>n&&(n=e[o].r),e[o].i=o,e[o].x=+e[o].x,e[o].y=+e[o].y;return{tree:0===e.length?{}:function e(t,o,n,i){var l,s={},c=i?"y":"x";return o===n?(s.point=t[o],s):1==n-o?(t[o][c]>t[n][c]?(s.point=t[o],s.left={point:t[n]}):(s.point=t[n],s.left={point:t[o]}),s):(l=o+n>>1,i?a(t,l,o,n):r(t,l,o,n),s.point=t[l],s.left=e(t,o,l-1,!i),s.right=e(t,l+1,n,!i),s)}(e,0,e.length-1,!1),search:function(e,t,o,r){function a(e,t,o,r){return s(g(e-o,2)+g(t-r,2))}function i(r,n){return"circle"===o?a(r,n,e,t)<=m:r>=m&&r<=b&&n>=v&&n<=y}function l(e,t,o){return e>=t&&e<=o}function c(o){var r=l(e,o.x1,o.x2)&&l(t,o.y1,o.y2),n=a(e,t,o.point.x,o.point.y);return d?void(r?C?o.point.i>d.point.i&&(d=o,C=r,_=n):(d=o,C=r,_=n):!C&&n<_&&(d=o,C=r,_=n)):(d=o,C=r,void(_=n))}function h(r,a){"circle"===o?m=r:(m=e-r||0,b=e+r||0,v=t-a||0,y=t+a||0)}var d,p,u,f=this.tree,m=e-n,b=e+n,v=t-n,y=t+n,C=!1,_=0;return r=r||{},u=function(e){e&&e.point&&(h(r.rx||e.point.r,r.ry||e.point.r),i(e.point.x,e.point.y)&&c(e),v<=e.point.y&&p(e.left),y>=e.point.y&&p(e.right))},(p=function(e){e&&e.point&&(h(r.rx||e.point.r,r.ry||e.point.r),i(e.point.x,e.point.y)&&c(e),m<=e.point.x&&u(e.left),b>=e.point.x&&u(e.right))})(f),d&&d.point||d}}}(e),this.tree=this.kdTree.tree,this}getNeighbour(e,t,o){var r=this,a=r.tree,n={x1:e.x-r.xLimit,x2:e.x+r.xLimit,y1:e.y-r.yLimit,y2:e.y+r.yLimit},i=r.validatorFn;return r.mousePoint=e,t?this.kdTree&&this.kdTree.search(e.x,e.y,o,e.options):a?r._searchBtwnLimit(n,a,!0,i):void 0}_searchBtwnLimit(e,t,o,r){var a,n,i=o?"x":"y",l=o?e.x1:e.y1,s=o?e.x2:e.y2;if((a=t&&t.point&&t.point[i])!==Q)return r(t.point)&&(n=t.point),a>=l&&t.left&&(n=ce(n,this._searchBtwnLimit(e,t.left,!o,r))),a<=s&&t.right&&(n=ce(n,this._searchBtwnLimit(e,t.right,!o,r))),n}_setSearchLimit(e,t){this.xLimit=e,this.yLimit=t}}he.prototype.constructor=he;var de=he;let ge,pe="",ue="top",fe="bottom",me="right",be="left",ve="middle",ye="center",Ce=.6,_e=window.Math,xe=_e.min,Oe=_e.max,ke="items",we=function(){let e,t=this,o=t.dataset.getFromEnv("chart"),r=t.dataset.getChildren("mapAnnotations")[0],a=t.markerShape,n=a.groupConfig,i=a.data("unfilteredConfig"),c=i._markerEventArgs,h=t.config;i.hovereffect&&("circle"===a.config.type&&(e=Object(s._0)({fillcolor:i.hoverfillcolor,fillalpha:i.hoverfillalpha,fillangle:i.hoverfillangle,fillratio:i.hoverfillratio,gradientUnits:"objectBoundingBox",radialGradient:1},i._hoverattrs)),e=Object(s._0)({},i._hoverattrs),r.update(a.getId(),e)),c||(c=i._markerEventArgs={x:+i.x,y:+i.y,scaledX:i.x*n.scaleX,scaledY:i.y*n.scaleY,chartX:i.x*n.scaleX+n.grpXShift,chartY:i.y*n.scaleY+n.grpYShift,id:i.id,label:i.label}),Object(l.e)(h.options.id,"markerRollOver",c,o.getFromEnv("chartInstance"),h,ge,ge,ge)},Fe=function(){let e,t=this,o=t.dataset.getFromEnv("chart"),r=t.dataset.getChildren("mapAnnotations")[0],a=t.markerShape,n=a.getElement(),i=t.config,c=a.data("unfilteredConfig");n&&c.hovereffect&&("circle"===a.config.type&&(e=Object(s._0)({fillcolor:a.config.rawColor,fillalpha:a.config.rawAlpha,fillangle:a.config.rawAngle,fillratio:a.config.rawRatio,gradientUnits:"objectBoundingBox",radialGradient:"radial"===a.config.rawFillPattern},c._defaultattrs)),e=Object(s._0)({},c._defaultattrs),r.update(a.getId(),e)),Object(l.e)(i.id,"markerRollOut",c._markerEventArgs,o.getFromEnv("chartInstance"),ge,ge,ge)},je=function(e){let t=this,o=t.config.options,r=t.dataset,a=r.getFromEnv("chart"),n=t.markerShape,i=n.config,l=n.groupConfig,s=r.getFromEnv("linkClickFN"),c=n.config.link,h=i._markerEventArgs;c&&s&&s.call({link:c},!0),h||(h=i._markerEventArgs={x:+i.x,y:+i.y,scaledX:i.x*l.scaleX,scaledY:i.y*l.scaleY,chartX:i.x*l.scaleX+l.grpXShift,chartY:i.y*l.scaleY+l.grpYShift,id:o.id,label:o.label}),a.fireChartInstanceEvent("markerClick",h,e)},Ae=function(e,t){let o,r=e&&e.length||!1,a=t||"id",n={};if(!e)return e;for(;r--;)(o=e[r])[a]!==ge&&(n[o[a].toLowerCase()]=o);return n};Object(h.a)({name:"mapsAnimation",type:"animationRule",extension:g});class Le extends Z{constructor(){super(),this.components={},this.getLabelAlignment={top:function(e,t,o){return{x:e.toString(),y:(t-o).toString(),align:ye,valign:ue}},left:function(e,t,o){return{x:(e-o).toString(),y:t.toString(),align:me,valign:ve}},right:function(e,t,o){return{x:(e+o).toString(),y:t.toString(),align:be,valign:ve}},bottom:function(e,t,o){return{x:e.toString(),y:(t+o).toString(),align:ye,valign:fe}},center:function(e,t){return{x:e.toString(),y:t.toString(),align:ye,valign:ve}}},this.getWrapWidth={right:function(){return arguments[1]},left:function(e,t){return e-t},center:function(e,t){return 2*xe(t,e-t)}},this.getWrapHeight={top:function(){return arguments[1]},middle:function(e,t){return 2*xe(t,e-t)},bottom:function(e,t){return e-t}},this.hoverFn=we,this.hoverOutFn=Fe,this.clickFn=je}getName(){return"markers"}getType(){return"dataset"}configureAttributes(e){if(!e)return;this.JSONData=e;let t,o=this,r=o.getChildren("mapAnnotations")&&o.getChildren("mapAnnotations")[0],a=o.getFromEnv("chart").config.markerOpts;r||(t=new c.a,o.attachChild(t,"mapAnnotations"),r=o.getChildren("mapAnnotations")[0]),r.destroy(),o.calculateDataLimits(),a.dataEnabled?this._parseMarkers():this.defineMarkersNShapes(),this.configureConnectors()}calculateMarkerRadiusLimits(){if(this.JSONData){let e=this,t=e.JSONData,o=e.config,r=e.getFromEnv("chart"),a=r.config.width,n=r.config.height,i=t.markermaxradius,l=t.markerminradius,s=Le.getMarkerRadiusLimits(a,n,i,l);o.minRadius=s.min,o.maxRadius=s.max}}calculateDataLimits(){let e,t,o,r,a,n=this.getFromEnv("chart"),i=this.config,l=(n.jsonData.markers||{})[ke]||[],s=this.getFromEnv("number-formatter"),c=1/0,h=-1/0;for(a=0,o=l.length;a<o;a++)r=(e=l[a]).value,null!==(t=s.getCleanValue(r))&&(c=xe(t,c),h=Oe(t,h));i.min=c,i.max=h}_parseMarkers(){let e,t,o,r,a,n,i,l,c=this,h=c.getFromEnv("chart"),d=h.jsonData.markers,g=d[ke],p=d.shapes,u=h.config.markerOpts,f=this.getFromEnv("number-formatter"),m=c.components.shapeObjs={},b=c.components.markerObjs={};if(g&&g.length){if(p&&p.length)for(t=p.length;t;t-=1)(l=(r=p[t-1]).id.toLowerCase())&&(m[l]=r);for(t=g.length;t--;)(l=(r=g[t]).id&&r.id.toLowerCase())&&((e=r.value)!==ge&&""!==e&&(e=parseFloat(e)),(a=(o=Le._initializeMarkerItem(l,r,null,h)).config.options.shapeid)&&"string"==typeof a&&(a=a.toLowerCase()),i=(n=o.config).options,n.cleanValue=f.getCleanValue(e),n.formattedValue=null===n.cleanValue?ge:f.dataLabels(e),n.fillColor=Object(s._38)(i.fillcolor,i.color,u.fillColor),n.fillAlpha=Object(s._38)(i.fillalpha,i.alpha,u.fillAlpha),n.fillRatio=Object(s._38)(i.fillratio,u.fillRatio),n.fillAngle=Object(s._38)(i.fillangle,u.fillAngle),n.borderThickness=Object(s._40)(i.borderthickness,u.borderThickness),n.borderColor=Object(s._38)(i.bordercolor,u.borderColor),n.borderAlpha=Object(s._38)(i.borderalpha,u.borderAlpha),n.labelPadding=i.labelpadding||u.labelPadding,o.dataset=c,r.__hideMarker&&(o._isHidden=!0),a&&(o.shapeObj=m[a]),b[l]=o)}}defineMarkersNShapes(){let e,t,o,r,a,n,i,l,c=this,h=c.getFromEnv("chart"),d=h.jsonData.markers,g=d.definition,p=this.getFromEnv("number-formatter"),u=h.config.markerOpts,f=Ae(g)||{},m=Ae(d.application)||{},b=d.shapes,v=c.components.shapeObjs=c.components.shapeObjs||(c.components.shapeObjs={}),y=c.components.markerObjs=c.components.markerObjs||(c.components.markerObjs={}),C={},_={};if(g&&g.length){for(r in v)C[r]=!1;for(r in y)_[r]=!1;if(b&&b.length)for(r=b.length;r;r-=1)(l=(n=b[r-1]).id.toLowerCase())&&(v[l]=n,C[l]=!0);for(l in f)n=f[l],a=y[l]=Le._initializeMarkerItem(l,n,m[l],h),_[l]=!0,a.dataset=c,i=a.config.options.shapeid,t=a.config,o=n.value,t.cleanValue=p.getCleanValue(o),e=t.options,t.formattedValue=null===t.cleanValue?ge:p.dataLabels(o),t.fillColor=Object(s._38)(e.fillcolor,e.color,u.fillColor),t.fillAlpha=Object(s._38)(e.fillalpha,e.alpha,u.fillAlpha),t.fillRatio=Object(s._38)(e.fillratio,u.fillRatio),t.fillAngle=Object(s._38)(e.fillangle,u.fillAngle),t.borderThickness=Object(s._40)(e.borderthickness,u.borderThickness),t.borderColor=Object(s._38)(e.bordercolor,u.borderColor),t.borderAlpha=Object(s._38)(e.borderalpha,u.borderAlpha),t.labelPadding=e.labelpadding||u.labelPadding,t.options.tooltext=Object(s._38)(e.tooltext,u.tooltext),t.link=e.link,i&&(a.shapeObj=v[i.toLowerCase()]);for(r in C)C[r]||delete v[r];for(r in y)_[r]||delete y[r]}}static getMarkerRadiusLimits(e,t,o,r){let a=xe(e,t);return r=parseFloat(r),o=parseFloat(o),isNaN(r)||isNaN(o)?isNaN(r)?isNaN(o)?{min:.02*a,max:.07*a}:{min:parseInt(o/10,10),max:o}:{min:r,max:10*r}:r<o?{min:r,max:o}:{min:o,max:r}}getDataLimits(){let e=this.config;return{min:e.min,max:e.max}}static _initializeMarkerItem(e,t,o){let r,a={},n=a.config;return n||(n=a.config={}),n.id=e,n.definition=t,n.application=o,n.hasValue=null,n.value=null,n.options=null,n.label=null,n.markerShape=null,n.markerLabel=null,n.drawOptions={shape:null,label:null},n.drawComplete=!1,r=a.config.options=Object(s._0)({},n.definition),n.dataEnabled?!isNaN(r.value)&&""!==r.value&&(a.value=parseFloat(r.value),a.hasValue=!0):n.applyAll?n.options=Object(s._0)(r,n.application):o&&(n.options=Object(s._0)(r,n.application)),a}configureConnectors(){let e,t,o,r,a,n,i,l,c,h,d,g,p,u,f=this,m=f.getFromEnv("chart"),b=f.getChildren("mapAnnotations")[0],v=m.jsonData,y=f.components,C=v.markers||{},_=C.connector||C.connectors||[],x=y.markerObjs,O=_.length,k=f.components.connectors,w=function(e){return function(t){let o=this.data("unfilteredConfig");o.hoverEffect&&b.update(this.getId(),o._hoverAttrs),m.fireChartInstanceEvent("connectorrollover",e,t)}},F=function(e){return function(t){let o=this.data("unfilteredConfig");o.hoverEffect&&b.update(this.getId(),o._defaultAttrs),m.fireChartInstanceEvent("connectorrollout",e,t)}},j=function(e){return function(t){m.fireChartInstanceEvent("connectorClick",e,t)}},A=m.config.connectorOpts,L={};for(k=f.components.connectors=[],u=0;u<O;u++)((p=_[u]).from||p.to)&&(t=x[p.from.toLowerCase()],o=x[p.to.toLowerCase()],t&&o)&&(r=_[u].label,(L=k[u])||(L=k[u]={}),L.config||(e=L.config={}),L.graphics||(L.graphics={}),(e=L.config=Object(s._0)({},p)).fromMarker=t,e.toMarker=o,e.link=p.link,e.showTooltip=Object(s._40)(p.showtooltip,A.showTooltip),a=e.tooltext=e.showTooltip?Object(s._38)(p.tooltext,A.tooltext):pe,n=e.thickness=Object(s._38)(p.thickness,A.thickness),i=e.color=Object(s._38)(p.color,A.color),l=e.alpha=Object(s._38)(p.alpha,A.alpha),e.hoverEffect=Object(s._40)(p.showhovereffect,A.showHoverEffect),c=Object(s._38)(p.hovercolor,A.hoverColor,i),h=Object(s._38)(p.hoveralpha,A.hoverAlpha,l),d=Object(s._38)(p.hoverthickness,A.hoverThickness,n),e.dashed=Object(s._38)(p.dashed,A.dashed),e.dashLen=Object(s._40)(p.dashlen,A.dashlen),e.dashGap=Object(s._40)(p.dashgap,A.dashgap),a&&(e.tooltext=a=Object(s._37)(Object(s._36)(a,[3,40,41,42,43],{label:r,fromId:t.config.definition.id,toId:o.config.definition.id,fromLabel:t.config.definition.label,toLabel:o.config.definition.label},void 0))),e.eventArgs={fromMarkerId:t.config.id,toMarkerId:o.config.id,label:r},e._hoverAttrs={color:c,alpha:h,thickness:d},e._defaultAttrs={color:i,alpha:l,thickness:n},e.type="line",e.onclick=j(e.eventArgs),e.onmouseover=w(e.eventArgs),e.onmouseout=F(e.eventArgs),r&&(!(g=L.labelConfig)&&(g=L.labelConfig={}),g.type="text",g.text=r,g.align=ye,g.valign=ve,g.font=A.font,g.fillcolor=A.fontColor,g.bgcolor=A.labelBgColor,g.bordercolor=A.labelBorderColor,g.tooltext=e.tooltext))}draw(){let e,t,o,r,a,n,i,l=this,s=l.getFromEnv("chart"),c=l.config,h=l.getChildren("mapAnnotations")[0],d=l.components.markerObjs,g=s.config,u=g.markerOpts,f=g.scalingParams,m=s.config.annotationConfig,b=[],v=[],y={};for(a in l.createContainer(),l._drawConnectors(),l.imageLoadCount=0,l.imageCount=0,i=h.addGroup(Object.assign(m,{id:"markers",fillalpha:"100",items:b,scaleimages:1}),l),n=h.addGroup(Object.assign(m,{id:"markerLabels",items:v,scaleimages:1}),l),l.components.markerGroup=i,l.components.markerLabelGroup=n,c.autoScale=u.autoScale?f.sFactor:1,d)e=null,(r=(t=d[a]).config).conIsHidden||(e=this._drawMarkerItem.call(t)),e&&(r._annotationIndex=b.length,y[a]=t,e.markerShape&&(o=Object.assign({align:"center",valign:"middle",animationLabel:"markerItem",autoscale:"image"===e.markerShape.type?0:1},e.markerShape),t.markerShape=h.addItem(i.getId(),o,l)),t.markerShape.data("unfilteredConfig",o),b.push(t.markerShape),e.markerLabel&&(o=Object.assign({animationLabel:"markerItem"},e.markerLabel),t.markerLabel=h.addItem(n.getId(),o,l),t.markerLabel.data("unfilteredConfig",o)),v.push(t.markerLabel));l.addJob("buildKdtree",l._buildKdTree.bind(l),p.b.kdTree)}_buildKdTree(){let e,t,o=this,r=o.components.kdArrayMap,a=o.components.markerGroup,n=[],i=a&&a.items,l=i&&i.length||0;for(t=0;t<l;t++)r[e=i[t].config.id]&&n.push(r[e]);o.components.kDTree||(o.components.kDTree=new de(!0)),o.components.kDTree._setSearchLimit(1/0,1/0),o.components.kDTree.buildKdTree(n)}_drawMarkerItem(){let e,t,o,r,a,n,i,l,c,h,d,g,p,u,f,m,b,v,y=this,C=y.dataset,_=C.getFromEnv("chart"),x=_.config,O=C.config,k=x.scalingParams,w=y.config,F=w.options,j=w.definition,A=x.markerOpts,L=A.dataLabels.style,S=F.shapeid,E=F.scale||1,I=F.label||pe,P=_.config.scalingParams.scaleFactor*_.config.baseScaleFactor,T=(F.labelpos||ue).toLowerCase(),R=w.formattedValue===ge?ge:w.formattedValue,M=F.tooltext||A.tooltext,B=Object(s._40)(j.radius,w.radius,A.radius)*E*O.autoScale||1e-4,D=w.fillColor,V=w.fillAlpha,N=w.fillRatio,G=w.fillAngle,H=w.borderThickness,W=w.borderColor,z=w.borderAlpha,X=C.getChildren("mapAnnotations")[0],K=C.components.kdArrayMap||(C.components.kdArrayMap={}),Y=y.config.id;if(w.autoScale=A.autoScale?P:1,S)return M=M?Object(s._37)(Object(s._36)(M,[1,2,3],{formattedValue:R,label:I},F)):R?I+A.tooltipSepChar+R:I,R!==ge&&null!==R?I=I+A.labelSepChar+R:isNaN(E)?E=1:0>E?E=0:5<E&&(E=5),Object(s._0)(F,{x:F.x&&F.x.toString(),y:F.y&&F.y.toString(),fillcolor:D,fillalpha:V,fillratio:N,fillangle:G,borderthickness:H,bordercolor:W,borderalpha:z,hovereffect:Object(s._38)(A.showHoverEffect),radius:B&&B.toString(),link:F.link,showshadow:Object(s._40)(F.showshadow,w.shadow),_markerLabel:I,_markerId:F.id,id:(F.id+pe).toLowerCase()}),delete F.tooltext,w.tooltext=!!A.showTooltip&&M,p=+F.x*k.sFactor+k.translateX,u=+F.y*k.sFactor+k.translateY,B=F.radius,"triangle"===S?(Object(s._0)(F,{type:"polygon",sides:3,startangle:A.startAngle}),v="polygon",b=3):"diamond"===S?(Object(s._0)(F,{type:"polygon",sides:4,startangle:A.startAngle}),v="polygon",b=4):"arc"===S?(m=B*Ce,Object(s._0)(F,{type:"arc",startangle:0,endangle:360,innerradius:m}),v="arc"):"circle"===S?(F.type="circle",v="circle"):(d=C.getShapeArgs.call(y),A.dataEnabled&&A.valueToRadius&&F.radius!==ge?delete d.radius:(!d.radius&&(d.radius=A.radius),d.radius*=E*w.autoScale),Object(s._0)(F,d),F.id=F._markerId&&F._markerId.toLowerCase(),m=d.innerradius,d.radius&&(B=d.radius),v=d.type&&d.type.toLowerCase(),b=d.sides,(B=+B)&&m&&B<m&&(g=B,F.radius=B=m,F.innerradius=m=g)),F.type=F.type&&F.type.toLowerCase(),Object(s._0)(F,{hoverfillcolor:Object(s._38)(F.fillhovercolor,A.hoverFillColor,F.fillcolor),hoverfillalpha:Object(s._38)(F.fillhoveralpha,A.hoverFillAlpha,F.fillalpha),hoverfillratio:Object(s._38)(F.fillhoverratio,A.hoverFillRatio,F.fillratio),hoverfillangle:Object(s._38)(F.fillhoverangle,A.hoverFillAngle,F.fillangle),hoverborderthickness:Object(s._40)(F.borderhoverthickness,A.hoverBorderThickness,F.borderthickness),hoverbordercolor:Object(s._38)(F.borderhovercolor,A.hoverBorderColor,F.bordercolor),hoverborderalpha:Object(s._38)(F.borderhoveralpha,A.hoverBorderAlpha,F.borderalpha)}),F._hoverattrs={fillalpha:F.hoverfillalpha,fillcolor:F.hoverfillcolor,fillangle:F.hoverfillangle,fillratio:F.hoverfillratio,borderThickness:"0"===F.showborder?0:F.hoverborderthickness,borderColor:F.hoverbordercolor,borderAlpha:F.hoverborderalpha},F._defaultattrs={fillalpha:F.fillalpha,fillcolor:F.fillcolor,fillangle:F.fillangle,fillratio:F.fillratio,borderThickness:"0"===F.showborder?0:F.borderthickness,borderColor:F.bordercolor,borderAlpha:F.borderalpha},"image"===F.type?(F.borderthickness=F.borderthickness||0,F.onload=function(e){let t=e.width,o=e.height;f={},F=this.config,p=(+F.derivedX-t/(2*k.sFactor))*k.sFactor,u=(+F.derivedY-o/(2*k.sFactor))*k.sFactor,(f=K[Y]||(K[Y]={})).x=p+k.translateX,f.y=u+k.translateY,f.element=y,f.shapeInfo={type:"rect",width:t,height:o},t&&o&&X.update(this.getId(),{x:p,y:u,width:t,height:o,autoscale:0}),C.imageLoadCount++,C.imageLoadCount===C.imageCount&&C._buildKdTree()},F.onerror=function(){C.imageLoadCount++,C.imageLoadCount===C.imageCount&&C._buildKdTree()},C.imageCount++):((f=K[Y]||(K[Y]={})).x=p,f.y=u,f.element=y,f.shapeInfo={type:v,sides:b,radius:+B+F.borderthickness/2,innerradius:m}),w.drawOptions.shape=F,A.showLabels?(h=F.labelpadding||A.labelPadding,t=(e=C._getLabelOptions(T,h,F)).align,o=e.valign,r=w._labelBaseWidth,a=w._labelBaseHeight,n=w._labelXOffset,i=w._labelYOffset,l=A.labelWrapWidth?A.labelWrapWidth:C.getWrapWidth[t](r,+e.x+n),c=A.labelWrapHeight?A.labelWrapHeight:C.getWrapHeight[o](a,+e.y+i),l>h&&(l-=h),c>h&&(c-=h),w.drawOptions.label=Object(s._0)({type:"text"},{text:I,tooltext:F.tooltext,x:e.x,y:e.y,align:t,valign:e.valign,wrap:1,wrapwidth:l,wrapheight:c,fontsize:L.fontSize/k.sFactor,font:L.fontFamily,fillcolor:L.fontColor}),{markerShape:F,markerLabel:w.drawOptions.label}):{markerShape:F}}highlightPoint(e,t){let o=e.element,r=this,a=t.originalEvent,n=r.getFromEnv("chart"),i=r.getFromEnv("toolTipController"),l=r.config.currentToolTip,s=n.config.lastHoveredPoint;s&&s!==e&&(s&&r.hoverOutFn.call(s.element),n.config.lastHoveredPoint=null,i.hide(l)),!1===e||("click"===t.type||"touchstart"===t.type?(n.config.lastHoveredPoint!==e&&r.hoverFn.call(o),r.clickFn.call(o,t)):"mousemove"===t.type&&n.config.lastHoveredPoint!==e&&r.hoverFn.call(o),o.config.tooltext&&(l?i.draw(a,o.config.tooltext,l):l=r.config.currentToolTip=i.draw(a,o.config.tooltext)),n.config.lastHoveredPoint=e)}_drawConnectors(){let e,t,o,r,a,n,i,l,s,c,h=this,d=h.getFromEnv("chart"),g=d.config.annotationConfig,p=h.components.connectors||(h.components.connectors=[]),u=p.length,f=d.config.scalingParams,m=d.config.connectorOpts,b=m.showLabels,v=h.getChildren("mapAnnotations")[0],y=[],C=[],_=[];for(_.push({id:"connectorLabels",fillalpha:"100",items:C}),_.push({id:"connectors",fillalpha:"100",items:y}),v.addGroup(Object.assign(g,_[1]),h),v.addGroup(Object.assign(g,_[0]),h),o=0;o<u;o++)p[o]&&(l=p[o].config.fromMarker.config,s=p[o].config.toMarker.config,r=l.options.x,a=l.options.y,n=s.options.x,i=s.options.y,p[o].config.x=r,p[o].config.y=a,p[o].config.tox=n,p[o].config.toy=i,y.push(p[o].config),c=Object.assign({animationLabel:"markerItem"},p[o].config),(e=v.addItem("connectors",c,h))&&e.data("unfilteredConfig",c),e.addEventListener("fc-mouseover",p[o].config.onmouseover),e.addEventListener("fc-mouseout",p[o].config.onmouseout),e.addEventListener("fc-click",p[o].config.onclick),p[o].labelConfig&&b&&(p[o].labelConfig.x=((+r+ +n)/2).toString(),p[o].labelConfig.y=((+a+ +i)/2).toString(),p[o].labelConfig.fontsize=m.fontSize/(f.scaleFactor*d.config.baseScaleFactor),C.push(p[o].labelConfig),c=Object.assign({animationLabel:"markerItem"},p[o].labelConfig),(t=v.addItem("connectorLabels",c,h))&&t.data("unfilteredConfig")))}getShapeArgs(){let e,t=this.config,o=Object(s._0)({},this.shapeObj);return t.autoScale=1,o?("polygon"===o.type?3>o.sides?o.type="circle":o.startangle=t.startAngle:"arc"===o.type&&(e=(o.radius||t.markerRadius)*t.autoScale,o.radius=e,o.innerradius=o.innerradius&&o.innerradius*t.autoScale||e*Ce),o):null}_getLabelOptions(e,t,o,r,a){let n,i,l,s=e&&e.toLowerCase();return this.getLabelAlignment[s]||(s="center"),i=+o.x,l=+o.y,n=+(n=r===ge||a===ge?o.radius||0:/^(top|bottom)$/gi.test(s)&&.5*a||/^(left|right)$/gi.test(s)&&.5*r||0)+ +t,this.getLabelAlignment[s](i,l,n)}addMarkerItem(e){let t,o,r,a,n,i,l,c=this,h=c.getFromEnv("chart"),d=e,g=c.components.markerObjs,p=c.components.shapeObjs,u=c.components.markerGroup,f=c.components.markerLabelGroup,m=c.getChildren("mapAnnotations")[0],b=c.getFromEnv("number-formatter"),v=h.config.markerOpts;if(l=d.id.toLowerCase()){if(g[l])return;delete d.value,c.imageLoadCount=0,(t=Le._initializeMarkerItem(l,d,null)).dataset=c,i=t.config.options.shapeid,r=t.config,n=d.value,r.cleanValue=b.getCleanValue(n),e=r.options,r.formattedValue=null===r.cleanValue?ge:b.dataLabels(n),r.fillColor=Object(s._38)(e.fillcolor,e.color,v.fillColor),r.fillAlpha=Object(s._38)(e.fillalpha,e.alpha,v.fillAlpha),r.fillRatio=Object(s._38)(e.fillratio,v.fillRatio),r.fillAngle=Object(s._38)(e.fillangle,v.fillAngle),r.borderThickness=Object(s._40)(e.borderthickness,v.borderThickness),r.borderColor=Object(s._38)(e.bordercolor,v.borderColor),r.borderAlpha=Object(s._38)(e.borderalpha,v.borderAlpha),r.labelPadding=e.labelpadding||v.labelPadding,r.options.tooltext=Object(s._38)(e.tooltext,v.tooltext),r.link=e.link,i&&(t.shapeObj=p[i&&i.toLowerCase()]),g[l]=t,o=c._drawMarkerItem.call(t),u&&f&&(o.markerShape&&(a=Object.assign({align:"center",valign:"middle",animationLabel:"markerItem",autoscale:"image"===o.markerShape.type?0:1},o.markerShape),t.markerShape=m.addItem(u.getId(),a,c),t.markerShape.data("unfilteredConfig",a)),o.markerLabel&&(a=Object.assign({animationLabel:"markerItem"},o.markerLabel),t.markerLabel=m.addItem(f.getId(),a,c),t.markerLabel.data("unfilteredConfig",a))),c._buildKdTree()}}updateMarkerItem(e,t){let o,r,a,n,i=this,l=i.getFromEnv("chart"),c=i.getChildren("mapAnnotations")[0],h=i.components.markerObjs,d=l.config.markerOpts,g={},p=h[e];if(p){for(r in o=p.config.options,Object(s._0)(o,t),i.imageLoadCount=0,a=p.config,t)g[r.toLowerCase()]=t[r]&&t[r].toString();a.fillColor=Object(s._38)(g.fillcolor,g.color,d.fillColor),a.fillAlpha=Object(s._38)(g.fillalpha,g.alpha,d.fillAlpha),a.fillRatio=Object(s._38)(g.fillratio,d.fillRatio),a.fillAngle=Object(s._38)(g.fillangle,d.fillAngle),a.borderThickness=Object(s._40)(g.borderthickness,d.borderThickness),a.borderColor=Object(s._38)(g.bordercolor,d.borderColor),a.borderAlpha=Object(s._38)(g.borderalpha,d.borderAlpha),a.labelPadding=g.labelpadding||d.labelPadding,a.options.tooltext=Object(s._38)(g.tooltext,d.tooltext),a.link=g.link,n=i._drawMarkerItem.call(p).markerShape,i._buildKdTree(),c.update(e,n)}}createContainer(){let e=this,t=e.getLinkedParent(),o=e.getFromEnv("animationManager"),r=t.getChildContainer("layer1");e.getChildContainer("abovePlotGroup")||e.addChildContainer("abovePlotGroup",o.setAnimation({el:"group",attr:{name:"abovePlotGroup",opacity:1},container:r,component:e,label:"group"})),e.getChildContainer("belowPlotGroup")||e.addChildContainer("belowPlotGroup",o.setAnimation({el:"group",attr:{name:"belowPlotGroup",opacity:1},container:r,component:e,label:"group"}))}_removeMarkerItem(e){let t,o,r=this.components,a=r.markerObjs,n=a[e],i=r.kdArrayMap;n&&(t=n.markerShape,o=n.markerLabel,t&&t.dispose(),o&&o.dispose(),delete i[e],this._buildKdTree()),delete a[e]}getElement(e){if(this.components.kDTree)return this.components.kDTree.getNeighbour(e)}}var Se=Le;Object(h.a)({name:"mapsAnimation",type:"animationRule",extension:g});var Ee=class extends a.a{getType(){return"group"}getName(){return"mapGroup"}configure(){this._mapChildren(e=>{e.configure&&e.configure()})}createContainer(){let e,t=this,o=t.getLinkedParent(),r=t.getFromEnv("animationManager"),a=o.getChildContainer();e=a.plotGroup,t.getChildContainer("plotShadow")||t.addChildContainer("plotShadow",r.setAnimation({el:"group",attr:{name:"manager-plot-shadow",opacity:1},container:e,component:t,label:"group"})),t.getChildContainer("plot")||t.addChildContainer("plot",r.setAnimation({el:"group",attr:{name:"manager-plot",opacity:1},container:e,component:t,label:"group"})),t.getChildContainer("layer0")||t.addChildContainer("layer0",r.setAnimation({el:"group",attr:{name:"ann-layer0",opacity:1},container:a.abovePlotGroup,component:t,label:"group"})),t.getChildContainer("layer1")||t.addChildContainer("layer1",r.setAnimation({el:"group",attr:{name:"ann-layer1",opacity:1},container:a.abovePlotGroup,component:t,label:"group"})),o.config.labelsOnTop?t.getChildContainer("layer0").toFront():t.getChildContainer("layer0").toBack()}_transformGroup(){let e=this,t=this.getFromEnv("chart"),o=t.getFromEnv("chartInstance"),r=e.getFromEnv("animationManager"),a=t.jsonData,n=e.getChildContainer("plot"),i=e.getChildContainer("plotShadow"),l=t.config.scalingParams;n.hide(),i.hide(),t.config.entitiesReady=!1,o.addEventListener("internal.mapdrawingcomplete",function(t){t.detachHandler(),s._23&&(o.args.link&&o.args.clickedEntityBox&&a.chart.linkedcharttransition,n&&r.setAnimation({el:n,attr:{transform:l.transformStr},component:e,label:"group"}),i&&r.setAnimation({el:i,attr:{transform:l.transformStr},component:e,label:"group"})),n.show(),i.show()}),t.checkComplete()}draw(){this.createContainer(),this._transformGroup()}getDataLimits(e){let t,o=this,r=1/0,a=-1/0,n=0,i=function(e){a=Math.max(a,e.max),r=Math.min(r,e.min)};return o._mapChildren(o=>o.getState("removed")||!1===o.getState("visible")?void(e&&(t=o.getDataLimits(e),i(t))):(n++,t=o.getDataLimits(e),void i(t))),n?o.setState("visible",!0):o.setState("visible",!1),this.config.range||(this.config.range={},this.config.range.min=this.config.dataMin,this.config.range.max=this.config.dataMax),{max:a,min:r}}},Ie=function(e){var t,o=e.getFromEnv("dataSource"),r=o.data||{},a=o.markers;Object(s.Q)(e,Ee,"mapGroup"),t=e.getChildren("mapGroup")[0],Object(s.V)(t,Z,"entities",1,[r]),a?Object(s.V)(t,Se,"markers",1,[a]):e.getDatasets()[1]&&e.getDatasets()[1].remove()},Pe=o(176);let Te,Re=function(e,t,o){let r=e[0],a=e[1],n=e[2],i=r+(t[0]-r)*o,l=a+(t[1]-a)*o,c=n+(t[2]-n)*o;return{hex:(s.e+(i<<16|l<<8|c).toString(16)).slice(-6),rgb:[i,l,c]}};var Me=class extends a.a{constructor(){super();let e=this;e.mapByCategory=!1,e.colorArr=[],e.noValidRange=!0,e.sortLegend=!1}__setDefaultConfig(){super.__setDefaultConfig(),this.config.defaultObj={code:"CCCCCC",alpha:"100"}}getType(){return"colorComponent"}getName(){return"colorBucket"}configure(e){if(!e)return;let t,o,r,a,n,i,l,c,h,d,g,p=this,u=p.mapByCategory,f=e.numberFormatter,m=e.colorRange||{},b=Object(s._0)([],m.color),v=this.getLinkedParent(),y=p.getFromEnv("dataSource"),C=Math.min(Math.max(Object(s._40)(y.chart.palette,0)-1,0),4),_=v.defaultPaletteOptions&&v.defaultPaletteOptions.paletteColors[C],x=Object(s._40)(f.getCleanValue(m.maxvalue),1/0),O=Object(s._40)(f.getCleanValue(m.minvalue),-1/0),k=p.colorArr;if(e.mapByCategory!==Te&&(u=p.mapByCategory=!!+e.mapByCategory),(b=u?b.filter(e=>e.code||e.color):b.filter(e=>e.minvalue||e.maxvalue)).forEach(e=>{e.minvalue&&e.maxvalue&&+e.maxvalue<+e.minvalue&&(c=e.maxvalue,e.maxvalue=e.minvalue,e.minvalue=c),e.minvalue?e.maxvalue?(d=f.getCleanValue(e.minvalue),h=f.getCleanValue(e.maxvalue),e.rangeLabel=f.dataLabels(d)+"-"+f.dataLabels(h)):(d=f.getCleanValue(e.minvalue),e.maxvalue=h=x,e.rangeLabel=h===1/0?">"+f.dataLabels(d):f.dataLabels(d)+"-"+f.dataLabels(h)):(e.minvalue=d=O,h=f.getCleanValue(e.maxvalue),e.rangeLabel=d===-1/0?"<"+f.dataLabels(h):f.dataLabels(d)+"-"+f.dataLabels(h))}),b.sort((e,t)=>+e.minvalue==+t.minvalue?e.maxvalue-t.maxvalue:e.minvalue-t.minvalue),b&&(t=b.length)){for(k.length=0,o=0;o<t;o+=1)l=b[o],r=Object(s._38)(l.color,l.code,_&&_[o]),a=Object(s._38)(l.alpha),i=Object(s._38)(l.bordercolor),n=Object(s._38)(l.borderalpha,100),h=Object(s._40)(l.maxvalue),d=Object(s._40)(l.minvalue),g=Object(s._38)(l.label,l.displayvalue,l.rangeLabel),(r&&h>=d||u&&g)&&k.push({code:r,alpha:a||"100",oriAlpha:a,maxvalue:h,minvalue:d,label:Object(s._37)(g),labelId:g.toLowerCase(),bordercolor:i,borderAlpha:n,name:l.name});p.sortedColorArr=p.colorArr.slice(0)}else p.noValidRange=!0,p.colorArr=[],p.sortedColorArr=[]}getColorObj(e){if(e===Te)return{outOfRange:!0};let t,o,r=this,a=r.sortedColorArr,n=r.gradient?1:0,i=a[n];if(r.mapByCategory){for(e=Object(s._37)(e).toLowerCase()||e.toString().toLowerCase();i;){if(i.labelId===e||i.maxvalue>=e&&i.minvalue<=e)return{code:i.code,alpha:i.alpha||"100",oriAlpha:i.oriAlpha,seriesIndex:n,legendItemId:i.legendItemId};i=a[n+=1]}return{outOfRange:!0}}if(r.gradient){if(r.scaleMin<=e&&r.scaleMax>=e){for(;i&&i.maxvalue<e;)i=a[n+=1];return o=(e-i.minvalue)/i.range,{code:Re(a[n-1].codeRGB,i.codeRGB,o).hex}}return{outOfRange:!0}}for(;i;){if(e<i.minvalue&&!t)return 0==n?{code:i.code,alpha:i.alpha||"100",oriAlpha:i.oriAlpha,seriesIndex:n,name:i.name,label:i.label,outOfRange:!0,bordercolor:i.bordercolor,borderalpha:i.borderAlpha}:{code:a[n-1].code,alpha:a[n-1].alpha||"100",oriAlpha:a[n-1].oriAlpha,seriesIndex:n,name:a[n-1].name,label:a[n-1].label,outOfRange:!0,bordercolor:a[n-1].bordercolor,borderalpha:a[n-1].borderAlpha};if(e>i.maxvalue&&n==a.length-1)return{code:i.code,alpha:i.alpha||"100",oriAlpha:i.oriAlpha,seriesIndex:n,name:i.name,label:i.label,outOfRange:!0,bordercolor:i.bordercolor,borderalpha:i.borderAlpha};if(i.maxvalue>e&&i.minvalue<=e)return{code:i.code,alpha:i.alpha||"100",oriAlpha:i.oriAlpha,seriesIndex:n,name:i.name,label:i.label,bordercolor:i.bordercolor,borderalpha:i.borderAlpha};if(e===i.maxvalue&&(t={code:i.code,alpha:i.alpha||"100",oriAlpha:i.oriAlpha,seriesIndex:n,name:i.name,label:i.label,bordercolor:i.bordercolor,borderalpha:i.borderAlpha}),n==a.length-1&&t)return t;i=a[n+=1]}return a.length?void 0:{outOfRange:!0}}getColorRangeArr(e,t){var o,r,a,n,i,l,c,h,d=this.colorArr,g=[];if(!this.defaultAsigned&&(e>t&&(o=e,e=t,t=o),e<t&&(n=this.getColorObj(e),l=this.getColorObj(t),n&&l))){for(i=e,r=n.seriesIndex,a=l.seriesIndex;r<=a;r+=1)(c=Object(s._0)({},d[r])).minvalue!==i&&(c.minvalue=i),g.push(c),h=c,i=c.maxvalue;h&&(h.maxvalue=t)}return g}};let Be,De=",",Ve=(e,t,o)=>{var r,a,n=Math.round,i=e.value,l=e.code,c=Object(s.m)(l),h=t.value,d=t.code,g=Object(s.m)(d);return r=h-i,a=[n(c[0]+(g[0]-c[0])/r*(o-i)),n(c[1]+(g[1]-c[1])/r*(o-i)),n(c[2]+(g[2]-c[2])/r*(o-i))],Object(s.A)(a)};var Ne=class extends a.a{constructor(){super(),this.colorRange={},this.valueRatio={},this.data={},this.mapByPercent=void 0}getType(){return"colorComponent"}getName(){return"gradientColorRange"}configure(e){if(!e)return;let t,o,r,a=this;for(a.data=e,a.appender="",r=a.colorRange=e.colorRange.sort(function(e,t){return e.value-t.value}),a.valueRatio=Be,a.values=[],t=0,o=r.length;t<o;t++)a.values.push(r[t].value)}getValueRatio(){var e,t,o=this.colorRange,r=o.length,a=this.valueRatio,n=o[r-1].value,i=o[0].value,l=0;if(a)return a;for(a=this.valueRatio=[],e=0;e<r;e++)t=(o[e].value-i)/(n-i),a.push(100*(t-l)),l=t;return a}getCumulativeValueRatio(){var e,t,o=this.colorRange,r=o.length,a=o[0].value,n=o[r-1].value,i=[];for(t=0;t<r;t++)e=o[t],i.push((e.value-a)/(n-a)*100);return i}getBoxFill(e){var t,o,r,a,n=this.colorRange,i=n.length,l=[];for(a=e?90:0,o=0;o<i;o++)t=n[o],l.push(t.code);return r={FCcolor:{alpha:"100,100,100",angle:a,color:l.join(De),ratio:this.getValueRatio().join(De)}},Object(s._53)(r)}getColorByValue(e){var t,o,r,a,n=this.values,i=this.colorRange;if(e!==Be&&null!==e){for(o=0,t=n.length;o<t;o++){if(e===n[o]){a=i[o].code;break}if(!o&&e<n[o]){r=!0;break}if(o===t-1&&e>n[o]){r=!0;break}if(e>n[o]&&e<n[o+1]){a=Ve(i[o],i[o+1],e);break}}return r?void 0:a}}};function Ge(e){return Object(s._21)(e||We)||We}let He="rgba(192,192,192,"+(s._29?.002:1e-6)+")",We="#000000",ze=function(){var e,t={legendCarpetConf:{spreadFactor:.85,allowDrag:!1,captionAlignment:"center",padding:{v:3,h:3},style:{fill:"#e4d9c1",stroke:"#c4b89d"}},legendCaptionConf:{spreadFactor:.2,padding:{v:2,h:2},style:{fill:"#786B50",fontFamily:"sans-serif",fontSize:"12px",fontWeight:"bold",fontStyle:"normal"},bound:{style:{stroke:"none"}}},legendBodyConf:{spreadFactor:.8,padding:{v:2,h:2},bound:{style:{stroke:"none"}}}};return t.legendAxisConf={legendAxisHeight:11,spreadFactor:.4,padding:{v:1,h:1},style:{stroke:"none","stroke-opacity":0,"stroke-width":1},line:{grooveLength:3,offset:8,style:{stroke:"rgba(255, 255, 255, 0.65)","stroke-width":1.5}},shadow:{style:{stroke:"none",fill:Object(s._53)({FCcolor:{alpha:"25,0,0",angle:360,color:"000000,FFFFFF,FFFFFF",ratio:"0,30,40"}})}},bound:{style:{stroke:"none"}}},t.sliderGroupConf={showTooltip:1,outerCircle:{rFactor:1.4,style:{fill:He,stroke:"#757575","stroke-width":3}},innerCircle:{rFactor:.65,style:{fill:He,stroke:"#FFFFFF"}}},t.axisTextItemConf={spreadFactor:.3,padding:{v:1,h:1},style:{fill:"#786B50",fontFamily:"sans-serif",fontSize:"12px",fontWeight:"normal",fontStyle:"normal"}},{init:function(t){e=t.chart},legacyDataParser:function(t,o){var r,a,n,i,l,c,h,d,g,p,u,f,m=Math.max,b=Math.min,v={},y=e.getFromEnv("number-formatter"),C=e.getFromEnv("dataSource"),_=C.dataset,x=C.data;if(o=o||{},!t)return!1;for("maps"!==e.defaultDatasetType||void 0!==o.min&&void 0!==o.max?"HeatMap"===e.getName()&&(void 0===o.min||void 0===o.max)&&(o={min:1/0,max:-1/0},_.forEach(e=>{e.data&&e.data.forEach(e=>{o.min=b(o.min,Object(s._40)(e.value,o.min)),o.max=m(o.max,Object(s._40)(e.value,o.max))})})):(o={min:1/0,max:-1/0},x&&x.forEach(e=>{o.min=b(o.min,Object(s._40)(e.value,o.min)),o.max=m(o.max,Object(s._40)(e.value,o.min))})),v.mapByPercent=u=!!Object(s._40)(t.mapbypercent,0),r=t.color||[],void 0===t.minvalue&&(t.minvalue=void 0===o.min?0:u?0:o.min),void 0===t.maxvalue&&(t.maxvalue=void 0===o.max?100:u?100:o.max),(t.maxvalue===t.minvalue||o.min===1/0||o.max===-1/0)&&(t.minvalue=0,t.maxvalue=100),f=!1,l=0,h=r.length;l<h;l++)if(r[l].maxvalue){f=!0;break}for(f||(r=[]),n=t.code,d=v.colorRange=[],v.gradient=!!Object(s._40)(t.gradient,1),r.length?n=Ge(n):(n?(i=Ge(n),n=Ge()):i=function(e){return Object(s._14)(e,1)}(n=Ge()),r.push({code:i,maxvalue:t.maxvalue,label:void 0})),function(t){var o,r,a,n=e.getFromEnv("number-formatter");for(o=0,r=t.length;o<r;o++)(a=t[o].maxvalue)&&(t[o].maxvalue=n.getCleanValue(a))}(r),r=r.sort(function(e,t){return e.maxvalue-t.maxvalue}),g=p=t.minvalue&&y.getCleanValue(t.minvalue),p=(void 0!==g||null!==g)&&(u?g+"%":y.legendValue(g)),d.push({code:Object(s.X)(n),value:g,displayValue:p,label:t.startlabel}),l=0,h=r.length;l<h;l++)c=Ge((a=r[l]).code||a.color),g=p=a.maxvalue,!isNaN(parseInt(g,10))&&(p=(void 0!==g||null!==g)&&(u?g+"%":y.legendValue(g)),d.push({code:Object(s.X)(c),value:g,displayValue:p,label:a.label||a.displayvalue}));return d[d.length-1].label=t.endlabel||a.label,v},getDefaultConf:function(e){return t[e]}}}();var Xe=class extends a.a{constructor(){super(),this.datasource={},this.config.legendItemIds=[]}configure(){let e,t,o,r=this,a=this.getFromEnv("chart"),n="maps"===a.defaultDatasetType,i="TreeMap"===a.getName(),l=this.getFromEnv("dataSource").chart.mapbycategory,c=a.getFromEnv("number-formatter"),h=a.config.showLegend,d=a.getChildren("colorRange")&&a.getChildren("colorRange")[0];a.addToEnv("colorManager",r),r.datasource=a.getFromEnv("dataSource"),e=r.datasource.colorrange,d&&d.remove({instant:!0}),h||(r.config.legendItemIds=[]),"gradient"==(t=n?e.gradient&&+e.gradient?"gradient":e.color?"icon":"none":i?"gradient":e.gradient&&"0"!=e.gradient&&!+l?"gradient":"icon")?(ze.init({chart:a}),o=ze.legacyDataParser(e),Object(s.Q)(a,Ne,"colorRange",1,[o]),d=a.getChildren("colorRange")[0],a.addToEnv("colorRange",d),o||(d._dontPlot=!0),r.config.legendItemIds=[],r._configureGradientLegend(d)):"icon"===t?(Object(s.Q)(a,Me,"colorRange",1,[{colorRange:e,sortLegend:0,mapByCategory:Object(s._40)(l,0),defaultColor:"cccccc",numberFormatter:c}]),a.addToEnv("colorRange",a.getChildren("colorRange")[0]),h&&r._addLegendItems()):"none"===t&&(a.deleteFromEnv("colorManager"),r.config.legendItemIds=[])}_configureGradientLegend(e){let t=this,o=t.getFromEnv("chart").getFromEnv("gLegend");o&&(o.setColorRange(e),t.addExtEventListener("rangeUpdated",function(e,o){t.fireEvent("legendUpdate",{"original-event":e,maxMinArray:o,component:"gradientlegend"})},o))}_addLegendItems(){let e,t,o,r,a,n=this,i=n.config,l=n.getFromEnv("chart"),c=l.getChildren("legend")[0],h=l.getFromEnv("colorRange").colorArr,d=h.length;for(r=0;r<d;r++)a={label:Object(s._38)(h[r].label,h[r].displayvalue),datasetObj:h[r],index:r},t=Object(s._14)(h[r].code,40),e={FCcolor:{color:h[r].code+","+h[r].code+","+t,ratio:"0,70,30",angle:270,alpha:"100,100,100"}},(o=c.getItem(i.legendItemIds[r]))||(i.legendItemIds.push(c.createItem(n)),(o=c.getItem(i.legendItemIds[r])).addEventListener("fc-click",o.itemClickFn)),o.removeLegendState("hidden"),h[r].legendItemId=o&&o.getId(),o.configure(a),o.setStateCosmetics("default",{symbol:{fill:Object(s._53)(e),rawFillColor:h[r].code}});for(r=d;r<i.legendItemIds.length;r++)c.disposeItem(i.legendItemIds[r]);i.legendItemIds.splice(d)}legendInteractivity(e){let t=this.getFromEnv("colorRange").colorArr[e.config.index];this.fireEvent("legendUpdate",{legendItem:e,colorObj:t,component:"legend"})}getColor(e){let t=this,o=t.datasource.colorrange;return!+t.datasource.chart.mapbycategory&&+o.gradient?{code:t.getColorByValue(e)}:t.getColorObj(e)}getValueRatio(){return this.getFromEnv("colorRange").getValueRatio()}getCumulativeValueRatio(){return this.getFromEnv("colorRange").getCumulativeValueRatio()}getBoxFill(e){return this.getFromEnv("colorRange").getBoxFill(e)}getColorByValue(e){return this.getFromEnv("colorRange").getColorByValue(e)}getColorObj(e){return this.getFromEnv("colorRange").getColorObj(e)}};var Ke=function(e){!function(e){let t=e.getChildren("colorManager");e.getFromEnv("dataSource").colorrange?t?(e.addToEnv("colorManager",t[0]),t[0].configure()):(t=new Xe,e.attachChild(t,"colorManager"),e.addToEnv("colorManager",t),t.configure()):(t&&(t[0].config.legendItemIds=[]),e.deleteFromEnv("colorManager"))}(e)};let Ye,Ue,Je,Qe={},Ze="rgba(192,192,192,"+(s._29?.002:1e-6)+")",qe=!1,$e=!0,et="%",tt=",",ot="#000000",rt={}.hasOwnProperty,at="M",nt="L";function it(e,t){return function e(t,o){var r,a;for(a in t)rt.call(t,a)&&(r=t[a],o[a]===Ye?o[a]=r:"object"==typeof r&&null!==r&&e(r,o[a]))}(e,t),t}function lt(e){return Object(s._21)(e||ot)||ot}function st(e){var t,o=e.fontSize+"";return o?(t=o.replace(/(\d+)(px)*/,"$1px"),e.fontSize=t,e):e}function ct(e){return!(e!==Ye&&void 0!==e&&null!==e&&!isNaN(e))}Qe.CAPTION="CAPTION",Qe.LEGEND_BODY="LEGEND_BODY",Qe.AXIS_LABEL="LEGEND_LABEL",Qe.LEGEND_AXIS="LEGEND_AXIS",Qe.RANGE="RANGE",Qe.AXIS_VALUE="AXIS_VALUE",Ue=function(){var e,t={legendCarpetConf:{spreadFactor:.85,allowDrag:!1,captionAlignment:"center",padding:{v:3,h:3},style:{fill:"#e4d9c1",stroke:"#c4b89d"}},legendCaptionConf:{spreadFactor:.2,padding:{v:2,h:2},style:{fill:"#786B50",fontFamily:"sans-serif",fontSize:"12px",fontWeight:"bold",fontStyle:"normal"},bound:{style:{stroke:"none"}}},legendBodyConf:{spreadFactor:.8,padding:{v:2,h:2},bound:{style:{stroke:"none"}}}};return t.legendAxisConf={legendAxisHeight:11,spreadFactor:.4,padding:{v:1,h:1},style:{stroke:"none","stroke-opacity":0,"stroke-width":1},line:{grooveLength:3,offset:8,style:{stroke:"rgba(255, 255, 255, 0.65)","stroke-width":1.5}},shadow:{style:{stroke:"none",fill:Object(s._53)({FCcolor:{alpha:"25,0,0",angle:360,color:"000000,FFFFFF,FFFFFF",ratio:"0,30,40"}})}},bound:{style:{stroke:"none"}}},t.sliderGroupConf={showTooltip:1,outerCircle:{rFactor:1.4,style:{fill:Ze,stroke:"#757575","stroke-width":3}},innerCircle:{rFactor:.65,style:{fill:Ze,stroke:"#FFFFFF"}}},t.axisTextItemConf={spreadFactor:.3,padding:{v:1,h:1},style:{fill:"#786B50",fontFamily:"sans-serif",fontSize:"12px",fontWeight:"normal",fontStyle:"normal"}},{init:function(t){e=t.chart},legacyDataParser:function(t,o){var r,a,n,i,l,c,h,d,g,p,u,f,m={},b=e.getFromEnv("number-formatter");if(!t)return!1;for(m.mapByPercent=u=!!Object(s._40)(t.mapbypercent,0),r=t.color||[],t.minvalue===Ye&&(t.minvalue=o.min===Ye?0:u?0:o.min),t.maxvalue===Ye&&(t.maxvalue=o.max===Ye?100:u?100:o.max),f=!1,l=0,h=r.length;l<h;l++)if(r[l].maxvalue){f=!0;break}for(f||(r=[]),n=t.code,d=m.colorRange=[],m.gradient=!!Object(s._40)(t.gradient,1),r.length?n=lt(n):(n?(i=lt(n),n=lt()):i=function(e){return Object(s._14)(e,1)}(n=lt()),r.push({code:i,maxvalue:t.maxvalue,label:Ye})),function(t){var o,r,a,n=e.getFromEnv("number-formatter");for(o=0,r=t.length;o<r;o++)(a=t[o].maxvalue)&&(t[o].maxvalue=n.getCleanValue(a))}(r),r=r.sort(function(e,t){return e.maxvalue-t.maxvalue}),g=p=t.minvalue&&b.getCleanValue(t.minvalue),p=(g!==Ye||null!==g)&&(u?g+et:b.legendValue(g)),d.push({code:Object(s.X)(n),value:g,displayValue:p,label:t.startlabel}),l=0,h=r.length;l<h;l++)c=lt((a=r[l]).code||a.color),g=p=a.maxvalue,!isNaN(parseInt(g,10))&&(p=(g!==Ye||null!==g)&&(u?g+et:b.legendValue(g)),d.push({code:Object(s.X)(c),value:g,displayValue:p,label:a.label||a.displayvalue}));return d[d.length-1].label=t.endlabel||a.label,m},getDefaultConf:function(e){return t[e]}}}();class ht{constructor(e){this.carpet=e}draw(e){return this.carpet.draw(e)}getLogicalSpace(e,t){return this.carpet.getLogicalSpace(e,t)}dispose(){this.carpet&&this.carpet.group&&this.carpet.group.remove()}}class dt{constructor(e){this.conf=e,this._id="GL_CARPET",this.compositionsByCategory={},this.node=Ye,this.group=Ye,this._lSpace=Ye,this.autoRecalculate=!1,this.groupName="fc-gradient-legend",this.moveInstructions={}}configure(e){this.conf=e}getName(){return"LegendCarpet"}getType(){return"legend"}addCompositions(e,t){this.compositionsByCategory[t]=e}removeCompositions(e){delete this.compositionsByCategory[e]}getBoundingBox(e){var t,o,r=this.conf,a=r.spreadFactor,n=e.refSide,i=e.alignment,l=e.refOffset,s=e.x,c=e.y;return"bottom"===this.conf.legendPosition?(t=r.width=n*a,o=e.maxOtherSide,i&&(s===Ye||null===s)&&(s=(l+n)/2-t/2)):(o=r.height=n*a,t=e.maxOtherSide,i&&(c===Ye||null===c)&&(c=(l+n)/2-o/2)),{width:t,height:o,x:s,y:c}}getPostCalcDecisionsH(e,t){var o,r=this.conf.padding,a=0;for(o in this.moveInstructions={},t)a+=t[o].height||0;e.height=a+2*r.v}getLogicalSpace(e,t){var o,r,a,n,i,l=this._lSpace,s=["CAPTION","LEGEND_BODY"],c=this.conf.padding,h=this.compositionsByCategory,d=0,g={},p=0;if(l&&!t)return l.isImpure=!0,l;(ct((l=this._lSpace=r=this.getBoundingBox(e)).x)||ct(l.y)||ct(l.height)||ct(l.width))&&(this.autoRecalculate=!0),(a=it(r,{})).height-=2*c.v,a.width-=2*c.h,a.x+=c.h,a.y+=c.v;for(let r=0;r<s.length;r++)(o=h[s[r]])&&((i=it(a,{})).y+=d,d=a.height*o.conf.spreadFactor,i.height=d+p,n=o.getLogicalSpace(it(i,{}),e,t),p=i.height-n.height,g[s[r]]=n,d=n.height);return this.getPostCalcDecisions(r,g),this._lSpace=r,r}setupDragging(){var e=this.group,t=0,o=0,r=0,a=0;e.css({cursor:"move"}),e.drag(function(n,i){t=n,o=i,e.attr({transform:"t"+(r+t)+","+(a+o)})},function(){r+=t,a+=o},s._51)}draw(e){var t,o,r,a=this.conf,n=["CAPTION","LEGEND_BODY"],i=this.compositionsByCategory,l=e.animationManager,s=e.parentGroup;this.getLogicalSpace(e,this.autoRecalculate),r=this._lSpace,this.group=t=l.setAnimation({el:this.group||"group",attr:{name:this.groupName},component:Je,container:s,label:"carpetGroup"}),this.node=l.setAnimation({el:this.node||"rect",attr:r,css:a.style,component:Je,container:t,label:"rect"});for(let s=0;s<n.length;s++)(o=i[n[s]])&&o.draw(a.captionAlignment,r,{animationManager:l,colorRange:e.colorRange,numberFormatter:e.numberFormatter,parentLayer:t,smartLabel:e.smartLabel,moveInstructions:this.moveInstructions[void 0],gLegend:e.gLegend});return a.allowDrag&&this.setupDragging(),this.node}getPostCalcDecisions(e,t){return"bottom"===this.conf.legendPosition?this.getPostCalcDecisionsH(e,t):this.getPostCalcDecisionsV(e,t)}getPostCalcDecisionsV(e,t){var o,r,a,n=this.conf.padding,i=Number.NEGATIVE_INFINITY,l=this.moveInstructions;for(r in this.getPostCalcDecisionsH(e,t),t)i=i<(o=t[r].width)?o:i;for(r in e.width=i+2*n.h,t)(a=i-(o=t[r].width))&&(l[r]="t"+a/2+",0")}}class gt{constructor(e,t){this.rawText=e,this.conf=t,this._id="GL_CAPTION",this.node=Ye,this.bound=Ye,this._lSpace=Ye,this.LegendCaption={},this.LegendCaption.LEFT={x:function(e,t){return t.x+e.width/2+2}},this.LegendCaption.RIGHT={x:function(e,t){return t.x+t.width-e.width/2-2}},this.LegendCaption.CENTER={x:function(){let e=arguments[1];return e.x+e.width/2}}}configure(e,t){this.rawText=e,this.conf=t}getName(){return"LegendCaption"}getType(){return"caption"}getLogicalSpace(e,t,o){var r,a,n,i,l=this.conf.padding,s=this._lSpace,c=this.rawText,h=t.gLegend.getFromEnv("chartConfig");return s&&!o?(s.isImpure=!0,s):(s=this._lSpace={bound:{height:0,width:0},node:{logicArea:Ye,smartText:Ye}},r=t.smartLabel,c?((a=it(e,{})).height-=2*l.v,a.width-=2*l.h,a.x+=l.h,a.y+=l.v,r.useEllipsesOnOverflow(h.useEllipsesWhenOverflow),st(i=it(this.conf.style,{})),r.setStyle(this._metaStyle=i),n=r.getSmartText(c,a.width,a.height),a.height=n.height,a.width=n.width,e.height=n.height+2*l.v,e.width=n.width+2*l.h,s.node.smartText=n,s.node.logicArea=a,s.bound=e,e):s.bound)}draw(){var e,t,o,r,a,n,i,l,s,c,h,d=this.conf,g=d.bound||{};return 3<=arguments.length?(i=arguments[0],l=arguments[1],s=arguments[2]):2<=arguments.length&&(i=arguments[0],s=arguments[1]),e=s.parentLayer,h=s.animationManager,this.group=t=h.setAnimation({el:this.group||"group",attr:{name:"legend-caption"},css:d.style,component:Je,container:e}),this.getLogicalSpace(l,s),c=(a=this._lSpace).node,r=a.bound,this.bound=o=h.setAnimation({el:this.bound||"rect",attr:r,css:g.style,container:t,component:Je}),n="string"==typeof i?this.LegendCaption[i.toUpperCase()].x(c.smartText,l||c.logicArea):i,this.node=h.setAnimation({el:this.node||"text",attr:{text:c.smartText.text,x:n,y:c.logicArea.y+c.smartText.height/2,lineHeight:this._metaStyle.lineHeight,fill:d.style.fill},container:t,component:Je}),{group:t,bound:o,node:this.node}}dispose(){this.group.remove(),this.bound.remove(),this.node.remove()}}class pt{constructor(e,t,o){this.colorRange=e,this.conf=t,this.childTextConf=o,this._id="GL_BODY",this.bound=Ye,this.group=Ye,this.compositionsByCategory={},this._lSpace=Ye,this.SC_STACK=[Qe.AXIS_LABEL,Qe.LEGEND_AXIS,Qe.AXIS_VALUE],this.DARW_STACK=[Qe.AXIS_VALUE,Qe.LEGEND_AXIS,Qe.AXIS_LABEL]}configure(e,t,o){this.colorRange=e,this.conf=t,this.childTextConf=o,this.compositionsByCategory={}}getName(){return"LegendBody"}getType(){return"legend"}addCompositions(e,t){this.compositionsByCategory[t]=e}getSpaceTaken(e){return"bottom"===this.conf.legendPosition?e.height:e.width}getLogicalSpace(e,t,o){var r,a,n,i,l,s,c,h=this._lSpace,d=this.conf.padding,g=this.compositionsByCategory,p=0;if(h&&!o)return h.isImpure=!0,h;for(h=this._lSpace={bound:{height:0,width:0},node:{logicArea:Ye}},(i=it(e,{})).height-=2*d.v,i.width-=2*d.h,i.x+=d.h,i.y+=d.v,l=this.getCompositionPlotAreaFor(i),t.colorRange=this.colorRange,s=0,c=this.SC_STACK.length;s<c;s++)(r=g[this.SC_STACK[s]])&&(a=l(n,r.conf.spreadFactor),n=r.getLogicalSpace(it(a,{}),t,o),p+=this.getSpaceTaken(n));return this.updateEffectivePlotArea(e,i,p),h.node.logicArea=i,h.bound=e,e}draw(){var e,t,o,r,a,n,i,l,s,c,h=this.childTextConf,d=this.conf.bound.style||{},g=this.compositionsByCategory;for(3<=arguments.length?(n=arguments[1],l=arguments[2]):2<=arguments.length&&(l=arguments[1]),t=l.parentLayer,e=l.animationManager,this.getLogicalSpace(n,l),i=this._lSpace,this.group=a=e.setAnimation({el:this.group||"group",attr:{name:"legend-body",transform:"t0,0"},css:h.style,container:t,component:Je}),this.bound=o=e.setAnimation({el:this.bound||"rect",attr:i.bound,css:d,container:a,component:Je}),l.colorRange=this.colorRange,l.parentLayer=a,s=0,c=this.DARW_STACK.length;s<c;s++)(r=g[this.DARW_STACK[s]])&&r.draw(l);return l.moveInstructions&&a.attr({transform:l.moveInstructions}),{bound:o,group:a}}getCompositionPlotAreaFor(e){var t,o="bottom"===this.conf.legendPosition;return t=it(e,{}),function(r,a){return r=r||{},o?(t.y+=r.height||0,t.height=e.height*a):(t.x+=r.width||0,t.width=e.width*a),t}}updateEffectivePlotArea(e,t,o){var r=this.conf.padding;"bottom"===this.conf.legendPosition?(t.height=o,e.height=o+2*r.v):(t.width=o,e.width=o+2*r.h)}}class ut{constructor(e){this.conf=e,this.node=[],this._id="GL_LABELS"}configure(e){this.conf=e}getType(){return"label"}getName(){return"LegendLabel"}getEffectivePlotArea(e){var t=this.conf.padding;return e.height-=2*t.v,e.width-=2*t.h,e.x+=t.h,e.y+=t.v,e}getLogicalSpace(e,t,o){var r,a,n,i,l,s,c,h,d,g,p,u,f,m,b,v,y,C,_,x,O,k,w,F=Math.max,j="bottom"===this.conf.legendPosition,A=this._lSpace,L=this.conf,S=L.padding,E=[],I=t.gLegend.getFromEnv("chartConfig"),P=[];if(A&&!o)return A.isImpure=!0,A;for(r=t.colorRange,a=t.smartLabel,g=r.getCumulativeValueRatio(),n=r.colorRange,f=(A=this._lSpace={bound:{height:0,width:0},node:{logicArea:Ye,smartTexts:[]}}).node.smartTexts,h=it(e,{}),b=this.getEffectivePlotArea(h),w=j?b.width:b.height,a.useEllipsesOnOverflow(I.useEllipsesWhenOverflow),k=it(L.style,{}),st(this._metaStyle=k),a.setStyle(k),v=a.getSmartText("W"),i=0,l=n.length;i<l;i++)(d=n[i].label)?P.push({oriIndex:i,label:d}):f[i]=Ye;if(0===(l=P.length))return{height:0,width:0};for(u=p=1<l?(g[P[l-1].oriIndex]-g[P[0].oriIndex])/2*w/100:F(g[P[0].oriIndex],100-g[P[0].oriIndex])/2*w/100,j?((x=a.getSmartText(P[0].label,u,b.height)).x=g[P[0].oriIndex]*b.width/100,s=x.x+x.width):((x=a.getSmartText(P[0].label,u,b.width)).y=g[P[0].oriIndex]*b.height/100,s=x.y+x.width),E.push(x.height),f[P[0].oriIndex]=x,j?((x=a.getSmartText(P[l-1].label,u,b.height)).x=g[P[l-1].oriIndex]*b.width/100,c=x.x-x.width):((x=a.getSmartText(P[l-1].label,u,b.width)).y=g[P[l-1].oriIndex]*b.height/100,c=x.y-x.width),E.push(x.height),f[P[l-1].oriIndex]=x,_=s,i=1;i<l-1;i++)d=P[i].label,O=P[i].oriIndex,x=Ye,y=i+1===l-1?c:g[P[i+1].oriIndex]*w/100,C=g[P[i].oriIndex]*w/100,(p=Math.min(C-_,y-C))>2*v.width&&(j?(x=a.getSmartText(d,p,b.height)).x=g[O]*b.width/100:(x=a.getSmartText(d,p,b.width)).y=g[O]*b.height/100,_=p,E.push(x.height)),f[P[i].oriIndex]=x;return m=F.apply(Math,E),j?(b.height=m,e.height=m+2*S.v):(b.width=m,e.width=m+2*S.v),A.node.logicArea=b,A.bound=e,e}draw(){var e,t,o,r,a,n,i,l,s,c,h,d,g="bottom"===this.conf.legendPosition,p=this.conf,u=p.bound&&p.bound.style||{stroke:"none"},f={};2<=arguments.length&&arguments[1]?(r=arguments[0],i=arguments[1]):1<=arguments.length&&(i=arguments[0]),d=i.animationManager,e=i.parentLayer,this.getLogicalSpace(r,i),s=(n=this._lSpace).node.logicArea,c=n.node.smartTexts,this.group=o=d.setAnimation({el:this.group||"group",attr:{name:"legend-labels"},container:e,component:Je}),this.bound=t=d.setAnimation({el:this.bound||"rect",attr:n.bound,css:u,container:o,component:Je});for(let e=0;e<this.node.length;e++)this.node[e].remove();for(this.node=[],l=0,h=c.length;l<h;l++)(a=c[l])&&(g?(f.y=s.y+a.height/2,f.x=l===h-1?s.x+a.x-a.width/2:l?s.x+a.x:s.x+a.x+a.width/2):(f.x=s.x+a.height/2,f.y=l===h-1?s.y+a.y-a.width/2:l?s.y+a.y:s.y+a.y+a.width/2),this.node.push(d.setAnimation({el:"text",attr:{text:a.text,x:f.x,y:f.y,lineHeight:this._metaStyle.lineHeight,fill:p.style.fill,transform:g?"R0":"R270,"+f.x+","+f.y},container:o,component:Je})));return{group:o,bound:t,node:this.node}}}class ft{constructor(e){this.conf=e,this._id="FL_AXIS",this.node=Ye,this.group=Ye,this.shadow=Ye,this.markerLine=Ye,this.compositionsByCategory={}}configure(e){this.conf=e}getName(){return"LegendAxis"}getType(){return"axis"}addCompositions(e,t){this.compositionsByCategory[t]=e}getLogicalSpace(){var e,t,o,r,a,n,i="bottom"===this.conf.legendPosition,l=arguments[0],s=arguments[2],c=this._lSpace,h=this.conf,d=h.padding,g=h.legendAxisHeight,p=this.compositionsByCategory,u=0;return c&&!s?(c.isImpure=!0,c):(c=this._lSpace={bound:{height:0,width:0},node:{logicArea:Ye}},(a=it(l,{})).height-=2*d.v,a.width-=2*d.h,a.x+=d.h,a.y+=d.v,e=g/2+h.line.offset,t=g/2,(r=p[Qe.RANGE])&&(n=r.sliders.false.conf.outerCircle.rFactor*g,t+=u=Math.max(n/2-g/2,0)),i?(a.y+=u,a.height=o=t+e+u,l.height=o+2*d.v):(a.x+=u,a.width=o=t+e+u,l.width=o+2*d.v),c.node.logicArea=a,c.bound=l,l)}getDrawableAxisArea(e){var t=this.conf,o="bottom"===this.conf.legendPosition;return{x:e.x,y:e.y,width:o?e.width:t.legendAxisHeight,height:o?t.legendAxisHeight:e.height,r:t.legendAxisHeight/2}}preDrawingRangeParamV(e){return{x:e.x+e.width/2,calculationBase:e.width,rangeStart:e.y,rangeEnd:e.y+e.height,prop:"x"}}preDrawingRangeParamH(e){return{y:e.y+e.height/2,calculationBase:e.height,rangeStart:e.x,rangeEnd:e.x+e.width,prop:"y"}}preDrawingRangeParam(e){return"bottom"===this.conf.legendPosition?this.preDrawingRangeParamH(e):this.preDrawingRangeParamV(e)}getScaleMarkerPathStrH(e,t){var o,r,a,n,i,l=it(e,{}),s=this.conf.line,c="",h="";for(l.x+=l.r,l.width-=2*l.r,i=l.y+l.height,o=0,r=t.length;o<r;o++)a=t[o],n=l.x+a*l.width/100,c+=at+n+tt+(i-s.grooveLength)+nt+n+tt+(i+s.offset);return c+(h+=at+l.x+tt+(i+s.offset)+nt+(l.x+l.width)+tt+(i+s.offset))}getColorGradientH(e){return{axis:e.getBoxFill(),shadow:Object(s._53)({FCcolor:{alpha:"25,0,0",angle:90,color:"000000,FFFFFF,FFFFFF",ratio:"0,30,40"}})}}draw(){var e,t,o,r,a,n,i,l,s,c,h,d,g,p,u=this.conf,f=u.bound||{},m=u.line,b=f.style||{},v=this.compositionsByCategory;for(o in 2<=arguments.length?(t=arguments[0],d=arguments[1]):1<=arguments.length&&(d=arguments[0]),g=d.animationManager,e=d.parentLayer,a=(r=d.colorRange).getCumulativeValueRatio(),this.getLogicalSpace(t,d),h=this._lSpace,this.group=i=g.setAnimation({el:this.group||"group",attr:{name:"legend-axis"},container:e,component:Je}),this.bound=g.setAnimation({el:this.bound||"rect",attr:h.bound,css:b,component:Je,container:i}),c=this.getDrawableAxisArea(h.node.logicArea),s=this.getColorGradient(r),u.style.fill=s.axis,u.shadow.style.fill=s.shadow,this.node=g.setAnimation({el:this.node||"rect",attr:c,css:u.style,container:i,component:Je}),this.shadow=g.setAnimation({el:this.shadow||"rect",attr:c,css:u.shadow.style,container:i,component:Je}),p=this.getScaleMarkerPathStr(c,a),this.path=g.setAnimation({el:this.path||"path",attr:{path:p},css:m.style,container:i,component:Je}),v)n=v[o],o===Qe.RANGE&&(d[(l=this.preDrawingRangeParam(c)).prop]=l[l.prop],d.key=l.prop,d.rCalcBase=l.calculationBase,d.parentLayer=i,n.draw(l.rangeStart,l.rangeEnd,d))}getScaleMarkerPathStr(e,t){return"bottom"===this.conf.legendPosition?this.getScaleMarkerPathStrH(e,t):this.getScaleMarkerPathStrV(e,t)}getColorGradient(e){return"bottom"===this.conf.legendPosition?this.getColorGradientH(e):this.getColorGradientV(e)}getScaleMarkerPathStrV(e,t){var o,r,a,n,i,l=it(e,{}),s=this.conf.line,c="",h="";for(l.y+=l.r,l.height-=2*l.r,n=l.x+l.width,o=0,a=t.length;o<a;o++)r=t[o],i=l.y+r*l.height/100,c+=at+(n-s.grooveLength)+tt+i+nt+(n+s.offset)+tt+i;return c+(h+=at+(n+s.offset)+tt+l.y+nt+(n+s.offset)+tt+(l.y+l.height))}getColorGradientV(e){return{axis:e.getBoxFill(!0),shadow:Object(s._53)({FCcolor:{alpha:"25,0,0",angle:360,color:"000000,FFFFFF,FFFFFF",ratio:"0,30,40"}})}}}class mt{constructor(e,t,o){this.conf=t.conf,this.sliderIndex=e,this.rangeGroup=t.sliderGroup,this._id=o,this.node=Ye,this.tracker=Ye,this.currPos=0,this.swing=[]}configure(e,t,o){this.conf=t.conf,this.sliderIndex=e,this.rangeGroup=t.sliderGroup,this._id=o,this.currPos=0,this.swing=[]}getType(){return"slider"}getName(){return"Slider"}updateSwingRange(e,t){this.swing[+e]=t}draw(e,t,o,r){var a,n,i,l,s,c,h,d=Math.ceil,g=r.parentLayer,p=r.animationManager,u=this.conf,f=u.outerCircle,m=u.innerCircle,b=p.getFromEnv("chart").config,v=d(f.rFactor*r.rCalcBase/2),y=d(m.rFactor*r.rCalcBase/2),C="L"-y,_=r.gLegend.getFromEnv("toolTipController"),x=this.sliderIndex;return u.outerRadius=v,u.innerRadius=y,this._scaleVal=t,m.style["stroke-width"]=C,y+=l=d(f.style["stroke-width"]/2),n=this.node=p.setAnimation({el:this.node||"group",attr:{name:"fc-gl-slider",cursor:"pointer",transform:"t0,0"},container:g,component:Je}),"x"===r.key?(s=o,c=e,c+=x?-y:+y):(s=e,c=o,s+=x?-y:+y),this.oCircle=p.setAnimation({el:this.oCircle||"circle",attr:{cx:s,cy:c,r:v},css:f.style,container:n,component:Je}),this.iCircle=p.setAnimation({el:this.iCircle||"circle",attr:{cx:s,cy:c,r:y},css:m.style,container:n,component:Je}),h=this.tracker=p.setAnimation({el:this.tracker||"circle",attr:{cx:s,cy:c,r:v+5,fill:Ze,stroke:Ze,cursor:"pointer"},container:n,component:Je}),n.attr({transform:"x"===r.key?"t0,"+this.currPos:"t"+this.currPos+",0"}),a=b.showToolTip?t:"",_.enableToolTip(h,a),this._dragAPI=i=this.getDragAPI("x"===r.key),h.undrag(),h.drag(i.dragging,i.dragStart,i.dragEnd),{translateAscending:v+l}}getDragAPI(e){var t,o,r,a,n=this,i=n.node,l=n.sliderIndex,s=n.rangeGroup,c=n.conf.innerRadius;return{dragging:function(h){var d,g,p,u,f;return h.stopPropagation(),p=e?h.data[1]:h.data[0],l?(d=t[0]-t[1]+c,g=0):(d=0,g=t[1]-t[0]-c),(f=n.currPos+p)<d?p+=d-f:f>g&&(p-=f-g),i.attr({transform:e?"t0,"+(n.currPos+p):"t"+(n.currPos+p)+",0"}),o=p,r&&clearTimeout(r),r=setTimeout(function(){s.updateWhenInRest(n,n.currPos+p)},100),u=s.updateWhenInMove(n,n.currPos+p),n.conf.showTooltip&&n.tracker.data("__FC_tooltipText",u),a=!0,!0},dragStart:function(e){e.stopPropagation(),t=n.swing,a=!1,s.dragStarted(n)},dragEnd:function(){var e;s.dragCompleted(n,a,n.currPos+o),a&&(r&&clearTimeout(r),r=setTimeout(function(){s.updateWhenInRest(n,n.currPos)},100),n.currPos+=o,e=t[+l]+n.currPos,s.updateRange(n,e))}}}dispose(){this.node.remove(),this.oCircle.remove(),this.iCircle.remove(),this.tracker.remove()}}class bt{constructor(e){var t={};this._id="GL_SG1",this.conf=e,t.conf=e,this.extremes=[],this.sliders={},this.min=void 0,this.max=void 0,t.sliderGroup=this,this.valueRange=[],this.callbacks=[],this.sliders[qe]=new mt(qe,t,this._id+"_0"),this.sliders[$e]=new mt($e,t,this._id+"_1")}configure(e){var t={};this.min=void 0,this.max=void 0,this.conf=e,t.conf=e,t.sliderGroup=this,this.sliders[qe].configure(qe,t,this._id+"_0"),this.sliders[$e].configure($e,t,this._id+"_1")}getType(){return"slider"}getName(){return"SliderGroup"}initRange(e,t){var o=e.sliderIndex;this.extremes[+o]=t}updateRange(e,t){var o=e.sliderIndex;this.sliders[!o].updateSwingRange(o,t)}reset(){var e={};e.conf=this.conf,e.sliderGroup=this,this.min=void 0,this.max=void 0,this.sliders[qe].configure(qe,e,this._id+"_0"),this.sliders[$e].configure($e,e,this._id+"_1"),this.draw.apply(this,this._drawParams)}draw(e,t,o){var r,a,n,i,l,s=Math.ceil,c=this.sliders,h=c[!1],d=c[!0],g=o.colorRange,p=g.colorRange,u=g.data.mapByPercent,f=o.gLegend.getFromEnv("number-formatter");return this._fcChart=o.gLegend.getFromEnv("chart"),this.getValueFormPixel=function(e,t,o,r){this.getValueFormPixel=function(a){return e+(t-e)/(r-o)*a}},this.updateWhenInMove=function(e,t){this.updateWhenInMove=function(o,r){var a,n,i=this.extremes;return a=o.sliderIndex?i[1]-i[0]+r:r,n=this.getValueFormPixel(a),n=t?parseFloat(n).toFixed(2)+et:e.legendValue(n)}},this._drawParams=[e,t,o],this.updateWhenInMove(f,u),a=h.conf.outerCircle,n=s(h.conf.innerCircle.rFactor*o.rCalcBase/2),n+=s(a.style["stroke-width"]/2),this.extremes[0]=e+n,this.extremes[1]=t-n,i=this.extremes[1]-this.extremes[0],this.min=this.min?this.min:p[0].value,this.max=this.max?this.max:p[p.length-1].value,l=p[p.length-1].value-p[0].value,h.currPos=i*(this.min-p[0].value)/l,d.currPos=i*(this.max-p[0].value)/l-i,h.draw(e,u?f.legendPercentValue(this.min):f.legendValue(this.min),o[o.key],o),r=d.draw(t,u?f.legendPercentValue(this.max):f.legendValue(this.max),o[o.key],o),h.swing=this.extremes.slice(0),d.swing=this.extremes.slice(0),h.swing[1]+=d.currPos,d.swing[0]+=h.currPos,this.getValueFormPixel(p[0].value,p[p.length-1].value,this.extremes[0],this.extremes[1]),r}updateWhenInRest(e,t){var o,r,a=this.sliders,n=this.extremes,i=e.sliderIndex;i?(o=a[!i].currPos,r=n[1]-n[0]+t):(o=t,r=n[1]-n[0]+a[!i].currPos),this.min=+this.getValueFormPixel(o).toFixed(2),this.max=+this.getValueFormPixel(r).toFixed(2),this.gLegend.fireEvent("rangeUpdated",[{min:this.min,max:this.max}])}dragStarted(e){var t=this.sliders,o=this.extremes,r=e.conf,a=this._fcChart;a.fireChartInstanceEvent("legendpointerdragstart",{pointerIndex:+e.sliderIndex,pointers:[{value:this.getValueFormPixel(t.false.currPos)},{value:this.getValueFormPixel(o[1]-o[0]+t.true.currPos)}],legendPointerHeight:r.outerRadius,legendPointerWidth:r.innerRadius,outerRadius:r.outerRadius,innerRadius:r.innerRadius},[a.id])}dragCompleted(e,t,o){var r,a,n=this.sliders,i=this.extremes,l=e.conf,s=this.getValueFormPixel(n.false.currPos),c=this.getValueFormPixel(i[1]-i[0]+n.true.currPos),h=this._fcChart;e.sliderIndex?(r=s,a=this.getValueFormPixel(i[1]-i[0]+o)):(r=this.getValueFormPixel(o),a=c),t&&h.fireChartInstanceEvent("legendrangeupdated",{previousMinValue:s,previousMaxValue:c,minValue:r,maxValue:a},[h.id]),h.fireChartInstanceEvent("legendpointerdragstop",{pointerIndex:+e.sliderIndex,pointers:[{value:r},{value:a}],legendPointerHeight:l.outerRadius,legendPointerWidth:l.innerRadius,outerRadius:l.outerRadius,innerRadius:l.innerRadius},[h.id])}dispose(){this.sliders[qe].dispose(),this.sliders[$e].dispose()}}class vt extends ut{constructor(){super(arguments[0]),this._id="GL_VALUES",this.node=[]}configure(e){this.conf=e}getName(){return"LegendValues"}getType(){return"legend"}getLogicalSpace(e,t,o){var r,a,n,i,l,s,c,h,d,g,p,u,f,m,b,v,y,C,_,x,O,k,w,F,j,A=Math.min,L=Math.max,S="bottom"===this.conf.legendPosition,E=this._lSpace,I=this.conf,P=I.padding,T=t.gLegend.getFromEnv("chartConfig"),R=[],M=[];if(E&&!o)return E.isImpure=!0,E;for(r=t.colorRange,a=t.smartLabel,n=r.colorRange,c=r.getCumulativeValueRatio(),j=(E=this._lSpace={bound:{height:0,width:0},node:{logicArea:Ye,smartTexts:[]}}).node.smartTexts,(x=it(e,{})).height-=2*P.v,x.width-=2*P.h,x.x+=P.h,x.y+=P.v,a.useEllipsesOnOverflow(T.useEllipsesWhenOverflow),F=it(I.style,{}),st(this._metaStyle=F),a.setStyle(F),w=a.getSmartText("W"),s=n.length,S?(p=h=(c[s-1]-c[0])/2*x.width/100,k=n[0].displayValue,(i=a.getSmartText("string"!=typeof k&&k!==Ye&&k.toString()||k,p,x.height)).x=c[0]*x.width/100,u=i.x+i.width,R.push(i.height)):(p=h=(c[s-1]-c[0])/2*x.height/100,(i=a.getSmartText(n[0].displayValue,x.width,p)).y=c[0]*x.height/100,b=i.y+i.width,M.push(i.width)),j[0]=i,S?((i=a.getSmartText(n[s-1].displayValue,p,x.height)).x=c[s-1]*x.width/100,m=i.x-i.width,R.push(i.height),f=u):((i=a.getSmartText(n[s-1].displayValue,x.width,p)).y=c[s-1]*x.height/100,y=i.y-i.height,M.push(i.width),v=b),j[s-1]=i,l=1;l<s-1;l++)i=Ye,O=n[l].displayValue,S?(d=l+1===s-1?m:c[l+1]*x.width/100,(h=A((g=c[l]*x.width/100)-f,d-g))>1.5*w.width&&((i=a.getSmartText(O,2*h,x.height)).x=c[l]*x.width/100,f=h,R.push(i.height))):(d=l+1===s-1?y:c[l+1]*x.height/100,(h=A((g=c[l]*x.height/100)-v,d-g))>2*w.height&&((i=a.getSmartText(O,x.width,2*h)).y=c[l]*x.height/100,v=h,M.push(i.width))),j[l]=i;return S?(C=L.apply(Math,R),x.height=C,e.height=C+2*P.v):(_=L.apply(Math,M),x.width=_,e.width=_+2*P.h),E.node.logicArea=x,E.bound=e,e}draw(){var e,t,o,r,a,n,i,l,s,c,h,d,g,p=this.conf,u="bottom"===p.legendPosition,f=p.bound&&p.bound.style||{stroke:"none"},m={};2<=arguments.length&&arguments[1]?(r=arguments[0],i=arguments[1]):1<=arguments.length&&(i=arguments[0]),g=i.animationManager,e=i.parentLayer,l=i.colorRange.getCumulativeValueRatio(),this.getLogicalSpace(r,i),n=(a=this._lSpace).node.logicArea,h=a.node.smartTexts,this.group=o=g.setAnimation({el:this.group||"group",attr:{name:"legend-values"},container:e,component:Je}),this.bound=t=g.setAnimation({el:this.bound||"rect",attr:a.bound,css:f,container:o,component:Je});for(let e=0;e<this.node.length;e++)this.node[e].remove();for(this.node=[],s=0,c=l.length;s<c;s++)(d=h[s])&&(u?(m.y=n.y+d.height/2,m.x=s===c-1?n.x+d.x-d.width/2:s?n.x+d.x:n.x+d.x+d.width/2):(m.x=n.x+d.width/2,m.y=s===c-1?n.y+d.y-d.height/2:s?n.y+d.y:n.y+d.y+d.height/2),this.node.push(g.setAnimation({el:"text",attr:{text:d.text,x:m.x,y:m.y,lineHeight:this._metaStyle.lineHeight,fill:p.style.fill},container:o,component:Je})));return{group:o,bound:t}}}var yt=class extends a.a{getType(){return"gradientLegend"}getName(){return"gLegend"}constructor(){super(),Je=this,this.enabled=!1,this.drawOptions={},this.components={}}setColorRange(e){let t=this.drawOptions.colorRange=e;t&&t._preparationGoneWrong&&(this._dontPlot=!0)}configureAttributes(){var e,t,o,r,a,n,i,l,c,h,d=this,g=d.getFromEnv("chart"),p=d.getFromEnv("dataSource").chart,u=d.conf={},f=p.outcnvbasefont,m=p.outcnvbasefontsize,b=p.outcnvbasefontcolor,v=g.config.dataLabelStyle;Ue.init({chart:g}),d.data=d.getFromEnv("dataSource").colorrange,d._dontPlot||(d.drawOptions={smartLabel:d.getFromEnv("smartLabel"),gLegend:d},d._dontPlot=!1,d._recalculateLogicalSpace=!0,u.caption=Object(s._38)(p.legendcaption),u.legendPosition=Object(s._38)(p.legendposition,"bottom").toLowerCase(),u.showLegend=Object(s._40)(p.showlegend,1),u.interactiveLegend=Object(s._40)(p.interactivelegend,1),u.showLegendLabels=Object(s._40)(p.showlegendlabels,1),e=p.legenditemfontcolor||b,t=p.legenditemfont||f,o=p.legenditemfontsize||m,r=Object(s._40)(p.legenditemfontbold,0),a=p.legendcaptionfontcolor||b,n=p.legendcaptionfont||f,i=p.legendcaptionfontsize||m,l=Object(s._40)(p.legendcaptionfontbold,1),h=(c=p.legendaxisbordercolor?Object(s._25)(Object(s.X)(p.legendaxisbordercolor)):Ye)?Object(s._40)(p.legendaxisborderalpha,100)/100:Ye,u.axisTextItemConf={style:{fill:e?Object(s.R)(Object(s._38)(e)):v.color,fontFamily:t?Object(s._38)(t):v.fontFamily,fontSize:o?Object(s._40)(o):v.fontSize.match(/\d+/)[0],fontWeight:r?"bold":v.fontWeight}},u.legendCaptionConf={style:{fill:a?Object(s.R)(Object(s._38)(a)):v.color,fontFamily:n?Object(s._38)(n):v.fontFamily,fontSize:i?Object(s._40)(i):v.fontSize.match(/\d+/)[0],fontWeight:l?"bold":v.fontWeight,fontStyle:"normal"}},u.legendAxisConf={legendAxisHeight:11,style:{stroke:c,"stroke-opacity":h},line:{style:{stroke:Object(s.R)(Object(s._38)(p.legendscalelinecolor,"FFF8E9"),Object(s._40)(p.legendscalelinealpha,100)),"stroke-width":Object(s._40)(p.legendscalelinethickness)}}},u.sliderGroupConf={showTooltip:Object(s._40)(p.showtooltip,1),outerCircle:{rFactor:Object(s._40)(p.sliderdiameterfactor),style:{stroke:Object(s.R)(Object(s._38)(p.legendpointerbordercolor,"757575"),Object(s._40)(p.legendpointerborderalpha,100))}},innerCircle:{rFactor:Object(s._40)(p.sliderholediameterfactor),style:{stroke:Object(s.R)(Object(s._38)(p.legendpointercolor,"FFFFFF"),Object(s._40)(p.legendpointeralpha,100))}}},u.legendCarpetConf={spreadFactor:Object(s._40)(p.legendspreadfactor),allowDrag:!!Object(s._40)(p.legendallowdrag,0),captionAlignment:Object(s._38)(p.legendcaptionalignment,"center"),style:{fill:Object(s.R)(Object(s._38)(p.legendbgcolor,"e4d9c1"),Object(s._40)(p.legendbgalpha,100)),stroke:Object(s.R)(Object(s._38)(p.legendbordercolor,"c4b89d"),Object(s._40)(p.legendborderalpha,100)),"stroke-width":Object(s._40)(p.legendborderthickness,1)}})}postConfigureInit(){var e,t,o,r,a,n,i,l,s,c,h,d=this,g=d.conf;d.elem={},g.interactiveLegend?(r=it(Ue.getDefaultConf("sliderGroupConf"),g.sliderGroupConf),this.sGroup?((o=d.elem.sGroup=this.sGroup).configure(r),d.elem.sGroup.gLegend=d):(this.sGroup=d.elem.sGroup=o=new bt(r),o.configure(r),d.elem.sGroup.gLegend=d)):(this.sGroup&&this.sGroup.dispose(),this.sGroup&&delete this.sGroup),(r=it(Ue.getDefaultConf("legendCarpetConf"),g.legendCarpetConf)).legendPosition=g.legendPosition,h=Ue.getDefaultConf("legendBodyConf"),"bottom"===g.legendPosition?(d.drawOptions.refSideKey="canvasWidth",d.drawOptions.refOffsetKey="canvasLeft",a=it(Ue.getDefaultConf("axisTextItemConf"),g.axisTextItemConf),h.legendPosition="bottom",(c=it(Ue.getDefaultConf("legendAxisConf"),g.legendAxisConf)).legendPosition="bottom",a.legendPosition="bottom"):(d.drawOptions.refSideKey="canvasHeight",d.drawOptions.refOffsetKey="canvasTop",a=it(Ue.getDefaultConf("axisTextItemConf"),g.axisTextItemConf),h.legendPosition="right",(c=it(Ue.getDefaultConf("legendAxisConf"),g.legendAxisConf)).legendPosition="right",a.legendPosition="right"),Object.keys(this.components).length||(this.components.LegendCarpet=new dt,this.components.LegendBody=new pt,this.components.LegendAxis=new ft,this.components.LegendValues=new vt,g.showLegendLabels&&(this.components.LegendLabels=new ut)),t=this.components.LegendAxis,l=this.components.LegendValues,e=this.components.LegendCarpet,n=this.components.LegendBody,g.showLegendLabels&&(i=this.components.LegendLabels),this.components.LegendCarpet.configure(r),this.components.LegendValues.configure(a),this.components.LegendAxis.configure(c),this.components.LegendBody.configure(d.drawOptions.colorRange,h,a),g.showLegendLabels&&i.configure(a),g.caption?(s=it(Ue.getDefaultConf("legendCaptionConf"),g.legendCaptionConf),this.componentCaption&&Object.keys(this.componentCaption).length?this.componentCaption.configure(g.caption,s):(this.componentCaption=new gt).configure(g.caption,s),e.addCompositions(this.componentCaption,Qe.CAPTION)):(e.removeCompositions(Qe.CAPTION),this.componentCaption&&this.componentCaption.dispose(),delete this.componentCaption),o&&t.addCompositions(o,Qe.RANGE),i&&n.addCompositions(i,Qe.AXIS_LABEL),n.addCompositions(t,Qe.LEGEND_AXIS),n.addCompositions(l,Qe.AXIS_VALUE),e.addCompositions(n,Qe.LEGEND_BODY),d.elem.gl=new ht(e)}getValueRange(){var e,t,o=this.elem&&this.elem.sGroup,r=o.sliders,a=o.extremes;return e=r.false.currPos,t=a[1]-a[0]+r.true.currPos,[{min:o.getValueFormPixel(e),max:o.getValueFormPixel(t)}]}_dispose(){var e=this;e.elem&&e.elem.gl&&e.elem.gl.dispose(),e.elem={},super._dispose()}getCalculatedLogicalSpace(){return this._logicalArea}setCalculatedLogicalSpace(e){this._logicalArea=e}getLogicalSpace(e){var t,o,r,a=this,n=a.conf,i={height:0,width:0},l=a.drawOptions,s=a.getFromEnv("chartConfig");return a._recalculateLogicalSpace?a._dontPlot?i:(a._recalculateLogicalSpace=!1,a.postConfigureInit(),n.showLegend?(o=l.refSideKey,r=l.refOffsetKey,a.drawOptions.refSide=s[o],a.drawOptions.refOffset=s[r],a.drawOptions.maxOtherSide=e||a.drawOptions.maxOtherSide,a.elem.gl&&(t=a.elem.gl.getLogicalSpace(a.drawOptions,!0),a.elem.gl&&a.setCalculatedLogicalSpace(t)),a.getCalculatedLogicalSpace()):i):(o=l.refSideKey,r=l.refOffsetKey,a.drawOptions.refSide=s[o],a.drawOptions.refOffset=s[r],a.drawOptions.maxOtherSide=e||a.drawOptions.maxOtherSide,t=a.elem.gl.getLogicalSpace(a.drawOptions,!0),a.setCalculatedLogicalSpace(t),a.getCalculatedLogicalSpace()||i)}resetLegend(){var e;(e=this.elem&&this.elem.sGroup)&&e.reset()}allocatePosition(){var e,t,o,r,a,n,i=this.getFromEnv("chart"),l=i.config,s=this.conf||{},c=s.legendPosition,h=l.canvasLeft,d=l.canvasTop,g=l.canvasWidth,p=l.canvasHeight,u=l.marginBottom,f=l.marginRight;i.config.gLegendEnabled&&(e=this.getCalculatedLogicalSpace(),o=s.width=e.width,r=s.height=e.height,"bottom"===c?(a=h+(0>(t=g-o)?0:t/2),n=l.height-e.height-u-(l.actionBarHeight||0)):(n=d+(0>(t=p-r)?0:t/2),a=l.width-e.width-f),s.xPos=a,s.yPos=n)}draw(){var e=this.getFromEnv("chart"),t=e.getFromEnv("dataSource").colorrange,o=this.conf||{},r=e.hasGradientLegend;!e.config.gLegendEnabled||t&&r&&this.drawLegendComponent(o.xPos,o.yPos,{parentGroup:e.getContainer("parentgroup"),animationManager:e.getFromEnv("animationManager")})}drawLegendComponent(e,t,o){var r,a=this,n=a.conf;return a._dontPlot?void 0:n.showLegend?(a.drawOptions.animationManager=o.animationManager,a.drawOptions.parentGroup=o.parentGroup,a.drawOptions.x=e,a.drawOptions.y=t,a.drawOptions.maxOtherSide=a.drawOptions.maxOtherSide||o.maxOtherSide,r=a.elem.gl.draw(a.drawOptions).getBBox(),n.xPos=r.x,n.yPos=r.y,n.height=r.height,n.width=r.width,void(a.enabled=!0)):void(a.enabled=!1)}},Ct=o(178);var _t=function(e){!function(e){let t,o=e.getFromEnv("dataSource").colorrange,r=e.getFromEnv("dataSource").chart.mapbycategory,a="maps"===e.defaultDatasetType,n="TreeMap"===e.getName(),i=e.getFromEnv("legend"),l=e.getFromEnv("gLegend");"gradient"==(t=o&&e.config.showLegend?a?o.gradient&&+o.gradient?"gradient":o.color?"icon":"none":n?o.gradient&&"0"!=o.gradient?"gradient":"none":o.gradient&&"0"!=o.gradient&&!+r?"gradient":"icon":"none")?(e.deleteFromEnv("legend"),i&&i.remove(),Object(s.Q)(e,yt,"gLegend",1),(l=e.getChildren("gLegend")[0]).configure(),e.addToEnv("gLegend",l)):"icon"===t?(e.deleteFromEnv("gLegend"),l&&l.remove(),Object(s.Q)(e,Ct.a,"legend",1,{showLegend:!0}),(i=e.getChildren("legend")[0]).configure(),e.addToEnv("legend",i)):"none"===t&&(e.deleteFromEnv("gLegend"),e.deleteFromEnv("legend"),l&&l.remove(),i&&i.remove())}(e)};let xt,Ot=Object(s._0)({foregroundcolor:"333333",foregroundalpha:"100",foregrounddarkcolor:"111111",foregrounddarkalpha:"100",foregroundlightcolor:"666666",foregroundlightalpha:"100",backgroundlightcolor:"FFFFFF",backgroundlightalpha:"100",backgroundlightangle:90,backgroundlightratio:"",backgroundcolor:"FFFFCC",backgroundalpha:"100",backgrounddarkcolor:"ffcc66",backgrounddarkalpha:"100",backgrounddarkangle:270,backgrounddarkratio:"",shadow:1},n),kt="0,100",wt={basefontcolor:"foregroundcolor",bordercolor:"foregrounddarkcolor",borderalpha:"foregrounddarkalpha",bgcolor:"backgroundlightcolor",bgalpha:"backgroundlightalpha",bgangle:"backgroundlightangle",bgratio:"backgroundlightratio",canvasbordercolor:"foregrounddarkcolor",canvasborderalpha:"foregrounddarkalpha",canvasbgcolor:"backgroundlightcolor",canvasbgalpha:"backgroundlightalpha",canvasbgangle:"backgroundlightangle",canvasbgratio:"backgroundlightratio",tooltipbordercolor:"foregrounddarkcolor",tooltipborderalpha:"foregrounddarkalpha",tooltipbgcolor:"backgroundlightcolor",tooltipbgalpha:"backgroundlightalpha",tooltipfontcolor:"foregroundcolor",legendbordercolor:"foregrounddarkcolor",legendborderalpha:"foregrounddarkalpha",markerbordercolor:"foregroundlightcolor",markerborderalpha:"foregroundlightalpha",markerfillcolor:"backgrounddarkcolor",markerfillalpha:"backgrounddarkalpha",markerfillangle:"backgrounddarkangle",markerfillratio:"backgrounddarkratio",plotfillcolor:"backgroundcolor",plotfillalpha:"backgroundalpha",plotfillangle:"backgroundangle",plotfillratio:"backgroundratio",plothoverfillcolor:"backgrounddarkcolor",plothoverfillalpha:"backgrounddarkalpha",plothoverfillangle:"backgrounddarkangle",plothoverfillratio:"backgrounddarkratio",plotbordercolor:"foregroundcolor",plotborderalpha:"foregroundalpha",shadow:"shadow"},Ft={getMapName:function(){return this.jsVars.instanceAPI.getName().toLowerCase()},getEntityList:function(){let e,t,o,r,a,n,i,l=this.jsVars.instanceAPI.getDatasets()||[],s=l.length,c=[];for(e=0;e<s;e++)if("entities"===(i=(o=l[e]||[]).getName())){t=o;break}for(e in s=(r=t.components.data).length,r)r.hasOwnProperty(e)&&(n=(a=r[e]||{}).config||{},c.push({id:n.id,originalId:n.originalId||n.id,label:n.label,shortlabel:n.shortLabel,value:n.value,formattedValue:n.formattedValue,toolText:n.toolText}));return c},getMapAttribute:function(){return Object(l.f)(this,"12061210581","run","JavaScriptRenderer~getMapAttribute()",'Use of deprecated "getMapAttribute()". Replace with "getChartAttribute()".'),this.getChartAttribute.apply(this,arguments)},exportMap:function(){let e=this;return Object(l.f)(this,"12061210581","run","JavaScriptRenderer~exportMap()",'Use of deprecated "exportMap()". Replace with "exportChart()".'),e.exportChart&&e.exportChart.apply(e,arguments)},addMarker:function(e){let t,o,r,a,n=this.jsVars.instanceAPI.getDatasets()||[],i=n.length;for(t=0;t<i;t++)if("markers"===(a=(o=n[t]||[]).getName())){r=o;break}r&&!r.addMarkerItem(e)&&Object(l.f)(this,"1309264086","run","MapsRenderer~addMarker()","Failed to add marker. Check the options and try again.")},updateMarker:function(e,t){let o,r,a,n,i=this.jsVars.instanceAPI.getDatasets()||[],l=i.length;for(o=0;o<l;o++)if("markers"===(n=(r=i[o]||[]).getName())){a=r;break}a&&e&&(e=(e+Lt).toLowerCase(),a.updateMarkerItem(e,t))},removeMarker:function(e){let t,o,r,a,n=this.jsVars.instanceAPI.getDatasets()||[],i=n.length;for(t=0;t<i;t++)if("markers"===(a=(o=n[t]||[]).getName())){r=o;break}e&&(e=(e+Lt).toLowerCase(),r._removeMarkerItem(e))}},jt="none",At=", ",Lt="",St="bottom",Et="circle",It=window.Math,Pt=It.min,Tt=It.max,Rt=function(e,t){let o=Object(s._16)(t.getFromEnv("chart-container"),e),r=o.chartX,a=o.chartY,n=t.config,i=n.canvasLeft,l=n.canvasTop,c=n.canvasLeft+n.canvasWidth,h=n.canvasHeight+n.canvasTop;return o.insideCanvas=!1,o.originalEvent=e,r>i&&r<c&&a>l&&a<h&&(o.insideCanvas=!0),o};class Mt extends a.a{constructor(e,t){for(var o in super(),this.subpalette="",this.key="",this.index=t,e)this.subpalette=Ot[e[o]],this[o]=this.subpalette instanceof Array?this.subpalette[t]:this.subpalette,this.key=o}}class Bt extends r.a{constructor(){super(),this.friendlyName="Map",this.revision=1,this.hasCanvas=!0,this.standaloneInit=!1,this.defaultDatasetType="maps",this.defaultSeriesType="geo",this.fireGroupEvent=!0,this.legendposition="right",this.hasGradientLegend=!0,this.isMap=!0,this.defaultPaletteOptions={paletteColors:[["A6A6A6","CCCCCC","E1E1E1","F0F0F0"],["A7AA95","C4C6B7","DEDFD7","F2F2EE"],["04C2E3","66E7FD","9CEFFE","CEF8FF"],["FA9101","FEB654","FED7A0","FFEDD5"],["FF2B60","FF6C92","FFB9CB","FFE8EE"]],bgColor:["FFFFFF","CFD4BE,F3F5DD","C5DADD,EDFBFE","A86402,FDC16D","FF7CA0,FFD1DD"],bgAngle:[270,270,270,270,270],bgRatio:[kt,kt,kt,kt,kt],bgAlpha:["100","60,50","40,20","20,10","30,30"],toolTipBgColor:["FFFFFF","FFFFFF","FFFFFF","FFFFFF","FFFFFF"],toolTipBorderColor:["545454","545454","415D6F","845001","68001B"],baseFontColor:["555555","60634E","025B6A","A15E01","68001B"],tickColor:["333333","60634E","025B6A","A15E01","68001B"],trendColor:["545454","60634E","415D6F","845001","68001B"],plotFillColor:["545454","60634E","415D6F","845001","68001B"],borderColor:["767575","545454","415D6F","845001","68001B"],borderAlpha:[50,50,50,50,50]},this.colorPaletteMap=wt,this.eiMethods=Ft,this.registerFactory("legend",_t,["canvas"]),this.registerFactory("axis",()=>{},["canvas"]),this.registerFactory("colormanager-decider",Ke,["legend"]),this.registerFactory("dataset",Ie,["colormanager-decider"]),this.registerFactory("canvas",Pe.a)}_checkInvalidSpecificData(){return this.config.invalid=!1,!1}__setDefaultConfig(){super.__setDefaultConfig();var e=this.config;e.baseWidth||(e.baseWidth=400),e.baseHeight||(e.baseHeight=300),e.baseScaleFactor||(e.baseScaleFactor=1)}static getName(){return"maps"}static getType(){return"chartAPI"}getName(){return this.config.name||"GEO"}getType(){return"chartAPI"}configureAttributes(e){let t,o=this,r=o.getChildren("colorPalette")&&o.getChildren("colorPalette")[0];t=e.chart=e.chart||e.graph||e.map||{},o.jsonData=e,r||(r=new Mt(this.colorPaletteMap,(0<t.palette&&6>t.palette?t.palette:Object(s._40)(o.paletteIndex,1))-1),o.attachChild(r,"colorPalette")),o.config.skipCanvasDrawing=!0,super.configureAttributes(e),o._parseBackgroundCosmetics()}parseChartAttr(e){let t,o,r,a,n,i=this,l=i.jsonData,c=l.chart||l.map,h=l.markers,d=new Mt(this.colorPaletteMap,(0<c.palette&&6>c.palette?c.palette:Object(s._40)(i.paletteIndex,1))-1),g=Object(s._38)(c.entitybordercolor,c.bordercolor,d.plotbordercolor),p=Object(s._38)(c.entityfillcolor,c.fillcolor,d.plotfillcolor),u=Object(s._38)(c.entityfillalpha,c.fillalpha,d.plotfillalpha),f=Object(s._38)(c.entityfillratio,c.fillratio,d.plotfillratio),m=Object(s._38)(c.entityfillangle,c.fillangle,d.plotfillangle),b=Object(s._38)(c.nullentityfillcolor,c.nullentitycolor,p),v=Object(s._40)(c.usevaluesformarkers,l.markers&&l.markers.items&&l.markers.items.length,!(l.markers&&l.markers.application&&l.markers.application.length&&l.markers.definition&&l.markers.definition.length));super.parseChartAttr(e),(t=i.config).origMarginTop=Object(s._40)(c.charttopmargin,c.maptopmargin,11),t.origMarginLeft=Object(s._40)(c.chartleftmargin,c.mapleftmargin,11),t.origMarginBottom=Object(s._40)(c.chartbottommargin,c.mapbottommargin,11),t.origMarginRight=Object(s._40)(c.chartrightmargin,c.maprightmargin,11),t.labelsOnTop=Object(s._40)(c.entitylabelsontop,1),o=(n=t.style).inCancolor,r=n.inCanfontFamily,a=n.inCanfontSize,t.entityOpts={baseScaleFactor:t.baseScaleFactor,dataLabels:{style:{fontFamily:r,fontSize:a,lineHeight:n.inCanLineHeight,color:n.inCancolor}},fillColor:p,fillAlpha:u,fillRatio:f,fillAngle:m,borderColor:g,borderAlpha:Object(s._38)(c.entityborderalpha,c.borderalpha,i.borderAlpha,"100"),borderThickness:Object(s._40)(c.showentityborder,c.showborder,1)?Object(s._40)(c.entityborderthickness,c.borderthickness,1):0,scaleBorder:Object(s._40)(c.scaleentityborder,c.scaleborder,0),hoverFillColor:Object(s._38)(c.entityfillhovercolor,c.hoverfillcolor,c.hovercolor,d.plothoverfillcolor),hoverFillAlpha:Object(s._38)(c.entityfillhoveralpha,c.hoverfillalpha,c.hoveralpha,d.plothoverfillalpha),hoverFillRatio:Object(s._38)(c.entityfillhoverratio,c.hoverfillratio,c.hoverratio,d.plothoverfillratio),hoverFillAngle:Object(s._38)(c.entityfillhoverangle,c.hoverfillangle,c.hoverangle,d.plothoverfillangle),hoverBorderThickness:Object(s._38)(c.entityborderhoverthickness,c.hoverborderthickness),hoverBorderColor:Object(s._38)(c.entityborderhovercolor,g,d.plotbordercolor),hoverBorderAlpha:Object(s._38)(c.entityborderhoveralpha,d.plotborderalpha),nullEntityColor:b,nullEntityAlpha:Object(s._38)(c.nullentityfillalpha,c.nullentityalpha,u),nullEntityRatio:Object(s._38)(c.nullentityfillratio,c.nullentityratio,f),nullEntityAngle:Object(s._38)(c.nullentityfillangle,c.nullentityangle,m),connectorColor:Object(s._38)(c.labelconnectorcolor,c.connectorcolor,o),connectorAlpha:Object(s._38)(c.labelconnectoralpha,c.connectoralpha,"100"),connectorThickness:Object(s._40)(c.labelconnectorthickness,c.borderthickness,1),showHoverEffect:Object(s._40)(c.showentityhovereffect,c.usehovercolor,c.showhovereffect,1),hoverOnNull:Object(s._40)(c.hoveronnull,c.entityhoveronnull,1),labelPadding:Object(s._40)(c.labelpadding,5),showLabels:Object(s._40)(c.showlabels,1),labelsOnTop:Object(s._40)(c.entitylabelsontop,1),includeNameInLabels:Object(s._40)(c.includenameinlabels,1),includeValueInLabels:Object(s._40)(c.includevalueinlabels,0),useSNameInTooltip:Object(s._40)(c.usesnameintooltip,0),useShortName:Object(s._40)(c.usesnameinlabels,1),labelSepChar:Object(s._38)(c.labelsepchar,At),showTooltip:Object(s._40)(c.showentitytooltip,c.showtooltip,1),tooltipSepChar:Object(s._38)(c.tooltipsepchar,", "),tooltext:c.entitytooltext,hideNullEntities:Object(s._40)(c.hidenullentities,0),showHiddenEntityBorder:Object(s._40)(c.showhiddenentityborder,1),showNullEntityBorder:Object(s._40)(c.shownullentityborder,1),hiddenEntityColor:Object(s._38)(c.hiddenentitycolor,c.hiddenentityfillcolor,c.hiddenentityalpha||c.hiddenentityfillalpha?b:"ffffff"),hiddenEntityAlpha:Object(s._38)(c.hiddenentityalpha,c.hiddenentityfillalpha,.001),shadow:Object(s._40)(c.showshadow,i.defaultPlotShadow,d.shadow)},t.markerOpts={dataLabels:{style:{fontFamily:Object(s._38)(c.markerfont,r),fontSize:Object(s._40)(c.markerfontsize,parseInt(a,10)),fontColor:Object(s._38)(c.markerfontcolor,o)}},showTooltip:Object(s._40)(c.showmarkertooltip,c.showtooltip,1),showLabels:Object(s._40)(c.showmarkerlabels,c.showlabels,1),showHoverEffect:Object(s._40)(c.showmarkerhovereffect,1),labelPadding:Object(s._38)(c.markerlabelpadding,"5"),labelWrapWidth:Object(s._40)(c.markerlabelwrapwidth,0),labelWrapHeight:Object(s._40)(c.markerlabelwrapheight,0),fillColor:Object(s._38)(c.markerfillcolor,c.markerbgcolor,d.markerfillcolor),fillAlpha:Object(s._38)(c.markerfillalpha,d.markerfillalpha),fillAngle:Object(s._38)(c.markerfillangle,d.markerfillangle),fillRatio:Object(s._38)(c.markerfillratio,d.markerfillratio),fillPattern:Object(s._38)(c.markerfillpattern,d.markerbgpattern),hoverFillColor:c.markerfillhovercolor,hoverFillAlpha:c.markerfillhoveralpha,hoverFillRatio:c.markerfillhoverratio,hoverFillAngle:c.markerfillhoverangle,borderThickness:Object(s._38)(c.markerborderthickness,1),borderColor:Object(s._38)(c.markerbordercolor,d.markerbordercolor),borderAlpha:Object(s._40)(c.markerborderalpha,d.markerborderalpha),hoverBorderThickness:c.markerborderhoverthickness,hoverBorderColor:c.markerborderhovercolor,hoverBorderAlpha:c.markerborderhoveralpha,radius:Object(s._40)(c.markerradius&&Object(s._55)(c.markerradius),7),shapeId:Object(s._38)(c.defaultmarkershape,Et),labelSepChar:Object(s._38)(c.labelsepchar,At),tooltipSepChar:Object(s._38)(c.tooltipsepchar,", "),autoScale:Object(s._40)(c.autoscalemarkers,0),tooltext:Object(s._38)(h&&h.tooltext,c.markertooltext),dataEnabled:v,valueToRadius:Object(s._40)(c.markerradiusfromvalue,1),valueMarkerAlpha:Object(s._38)(c.valuemarkeralpha,"75"),hideNull:Object(s._40)(c.hidenullmarkers,0),nullRadius:Object(s._40)(c.nullmarkerradius,c.markerradius,7),adjustViewPort:Object(s._40)(c.adjustviewportformarkers,0),startAngle:Object(s._40)(c.markerstartangle,90),maxRadius:Object(s._40)(c.maxmarkerradius,0),minRadius:Object(s._40)(c.minmarkerradius,0),applyAll:Object(s._40)(c.applyallmarkers,0),shadow:Object(s._40)(c.showmarkershadow,c.showshadow,0)},t.connectorOpts={showHoverEffect:Object(s._40)(c.showconnectorhovereffect,1),thickness:Object(s._40)(c.connectorthickness,c.markerconnthickness,"2"),color:Object(s._38)(c.connectorcolor,c.markerconncolor,d.markerbordercolor),alpha:Object(s._38)(c.connectoralpha,c.markerconnalpha,"100"),hoverThickness:Object(s._40)(c.connectorhoverthickness,c.connectorthickness,c.markerconnthickness,"2"),hoverColor:Object(s._38)(c.connectorhovercolor,c.connectorcolor,c.markerconncolor,d.markerbordercolor),hoverAlpha:Object(s._38)(c.connectorhoveralpha,c.connectoralpha,c.markerconnalpha,"100"),dashed:Object(s._40)(c.connectordashed,c.markerconndashed,0),dashLen:Object(s._40)(c.connectordashlen,c.markerconndashlen,3),dashGap:Object(s._40)(c.connectordashgap,c.markerconndashgap,2),font:Object(s._38)(c.connectorfont,c.markerconnfont,r),fontColor:Object(s._38)(c.connectorfontcolor,c.markerconnfontcolor,o),fontSize:Object(s._40)(c.connectorfontsize,c.markerconnfontsize,parseInt(a,10)),showLabels:Object(s._40)(c.showconnectorlabels,c.showmarkerlabels,c.showlabels,1),labelBgColor:Object(s._38)(c.connectorlabelbgcolor,c.markerconnlabelbgcolor,d.plotfillcolor),labelBorderColor:Object(s._38)(c.connectorlabelbordercolor,c.markerconnlabelbordercolor,d.markerbordercolor),shadow:Object(s._40)(c.showconnectorshadow,c.showmarkershadow,c.showshadow,0),showTooltip:Object(s._40)(c.showconnectortooltip,c.showmarkertooltip,c.showtooltip,1),tooltext:Object(s._38)(h&&h.connectortooltext,c.connectortooltext),hideOpen:Object(s._40)(c.hideopenconnectors,1)},t.adjustViewPortForMarkers=Object(s._40)(c.adjustviewportformarkers,v)}_attachMouseEvents(){let e=this,t=e.getFromEnv("eventListeners"),o=e.getFromEnv("chart-container");t.push(i.a.listen(o,s._24?"touchstart":"click",Bt.searchMouseMove,e)),t.push(i.a.listen(window.document,s._24?"touchstart":"mousemove",Bt.searchMouseMove,e))}_dispose(){let e=this.getFromEnv("chart-container");s._24&&(i.a.unlisten(e,"touchstart",Bt.searchMouseMove),i.a.unlisten(window.document,"touchstart",Bt.searchMouseMove)),i.a.unlisten(e,"click",Bt.searchMouseMove),i.a.unlisten(window.document,"mousemove",Bt.searchMouseMove),super._dispose()}static searchMouseMove(e){let t,o=e.data,r=o.config,a=o.getDatasets()[1],n=a&&a.getFromEnv("toolTipController"),i=a&&a.config.currentToolTip,l=o.config.lastHoveredPoint,s={};o.getFromEnv("chart-container")&&o.config.lastInteractionEvent!==e.originalEvent&&(o.config.lastInteractionEvent=e.originalEvent,(t=Rt(e,o))&&t.insideCanvas?(r.lastMouseEvent=e,s={x:t.chartX,y:t.chartY},o._searchNearestNeighbour(s,e)):(l&&a&&a.hoverOutFn.call(l.element),o.config.lastHoveredPoint=null,n&&n.hide(i)))}_searchNearestNeighbour(e,t){let o,r=this.getDatasets()[1];if(r){if(!r.components.kDTree)return;(o=r.getElement(e))?r.highlightPoint(o,t):r.highlightPoint(!1,t)}}_createLayers(){super._createLayers(),this._attachMouseEvents()}_parseBackgroundCosmetics(){let e,t=this,o=t.getChildren("background")[0].config,r=t.getChildren("colorPalette")[0],a=t.getFromEnv("chart-attrib");e=o.showBorder=Object(s._40)(a.showcanvasborder,1),o.borderWidth=e?Object(s._40)(a.canvasborderthickness,1):0,o.borderRadius=o.borderRadius=Object(s._40)(a.canvasborderradius,0),o.borderDashStyle=o.borderDashStyle=Object(s._40)(a.borderdashed,0)?Object(s._8)(Object(s._40)(a.borderdashlen,4),Object(s._40)(a.borderdashgap,2)):jt,o.borderAlpha=Object(s._38)(a.canvasborderalpha,r.borderAlpha),o.borderColor=o.borderColor=Object(s.R)(Object(s._38)(a.canvasbordercolor,r&&r.borderColor),o.borderAlpha)}_getBackgroundCosmetics(){let e=this,t=e.getFromEnv("chart-attrib")||e.jsonData.map,o=e.getChildren("colorPalette")[0];return{FCcolor:{color:Object(s._38)(t.bgcolor,t.canvasbgcolor,o.bgcolor),alpha:Object(s._38)(t.bgalpha,t.canvasbgalpha,o.bgalpha),angle:Object(s._38)(t.bgangle,t.canvasbgangle,o.bgangle),ratio:Object(s._38)(t.bgratio,t.canvasbgratio,o.bgratio)}}}_parseCanvasCosmetics(){super._parseCanvasCosmetics();let e=this,t=e.config,o=e.getFromEnv("chart-attrib")||e.jsonData.map,r=e.getChildren("canvas")[0].config;t.origMarginTop=Object(s._40)(o.maptopmargin,11),t.origMarginLeft=Object(s._40)(o.mapleftmargin,11),t.origMarginBottom=Object(s._40)(o.mapbottommargin,11),t.origMarginRight=Object(s._40)(o.maprightmargin,11),t.origCanvasLeftMargin=Object(s._40)(o.canvasleftmargin,0),t.origCanvasRightMargin=Object(s._40)(o.canvasrightmargin,0),t.origCanvasTopMargin=Object(s._40)(o.canvastopmargin,0),t.origCanvasBottomMargin=Object(s._40)(o.canvasbottommargin,0),r.canvasBorderRadius=Object(s._40)(o.canvasborderradius,0),r.origCanvasTopPad=Object(s._40)(o.canvastoppadding,0),r.origCanvasBottomPad=Object(s._40)(o.canvasbottompadding,0),r.origCanvasLeftPad=Object(s._40)(o.canvasleftpadding,0),r.origCanvasRightPad=Object(s._40)(o.canvasrightpadding,0)}preliminaryScaling(){let e,t,o,r=this.jsonData,a=r.markers&&r.markers.items||[],n=a&&a.length||0,i=1/0,l=1/0,s=-1/0,c=-1/0;for(;n--;)e=+(o=a[n]).x,t=+o.y,i=Pt(i,e),l=Pt(l,t),s=Tt(s,e),c=Tt(c,t);return{x:i,y:l,x1:s,y1:c}}getScalingParameters(e,t,o,r){let a,n,i=e/t,l=o/(e*this.config.baseScaleFactor),s=r/(t*this.config.baseScaleFactor),c=0,h=0;return l>s?(c+=(o-r*i)/2,n=200/(t*(a=s))):(h+=(r-o/i)/2,n=200/(e*(a=l))),{scaleFactor:a,strokeWidth:n,translateX:c,translateY:h}}calculateMarkerBounds(e,t,o){let r,a,n,i,l,s,c,h,d,g,p,u,f,m,b=this,v=b.config,y=v.markerOpts,C=b.getDatasets(),_=b.getDataLimits(),x=_.dataMin,O=_.dataMax,k=y.hideNull,w=y.nullRadius,F=y.valueToRadius,j=1/0,A=1/0,L=-1/0,S=-1/0;for(s=0,d=C.length;s<d;s++)"markers"===(c=(h=C[s]).getName())&&(r=h);if(r)for(s in r.calculateMarkerRadiusLimits(),n=(a=r.config||{}).minRadius,i=a.maxRadius,l=r.components&&r.components.markerObjs||{})f=(v=(m=l[s]).config).definition||{},null!==v.cleanValue?(F&&f.radius===xt&&(v.radius=n+(i-n)*(v.cleanValue-x)/(O-x)),u=+v.radius,g=(+f.x+t)*e,p=(+f.y+o)*e,j=Pt(j,g-u),A=Pt(A,p-u),L=Tt(L,g+u),S=Tt(S,p+u)):k?v.__hideMarker=!0:null===v.radius&&(v.radius=w);return{x:j,y:A,x1:L,y1:S}}_spaceManager(){let e,t,o,r,a,n,i,l,c,h=this,d=h.config,g=h.getChildren("legend")&&h.getChildren("legend")[0],p=g&&g.config.legendPos,u=h.getFromEnv("chart-attrib"),f=d.showBorder,m=d.origMarginLeft,b=d.origMarginTop,v=h.config.baseWidth,y=h.config.baseHeight,C={},_=0,x=0,O=d.markerOpts,k=d.borderWidth=f?Object(s._40)(u.borderthickness,1):0;h._allocateSpace({top:k,bottom:k,left:k,right:k}),h._allocateSpace(h._manageActionBarSpace&&h._manageActionBarSpace(.225*d.availableHeight)||{}),l="right"===p?.3*d.canvasWidth:.3*d.canvasHeight,d.showLegend&&h._manageLegendSpace(l),e=p===St?.225*d.canvasHeight:.225*d.canvasWidth,c=h._manageChartMenuBar(e),o=d.canvasWidth,r=d.canvasHeight,O.dataEnabled?(d.adjustViewPortForMarkers?((C=h.preliminaryScaling()).x1>v&&(v=C.x1),0>C.x&&(v+=-C.x,_=-C.x),C.y1>y&&(y=C.y1),0>C.y&&(y+=-C.y,x=-C.y),t=h.getScalingParameters(v,y,o,r),n=r,i=o,0>(C=h.calculateMarkerBounds(t.scaleFactor*h.config.baseScaleFactor,_,x)).x&&(m+=-C.x,o+=C.x),0>C.y&&(b+=-C.y,r+=C.y),C.x1>i&&(o-=C.x1-i),C.y1>n&&(r-=C.y1-n)):(t=h.getScalingParameters(v,y,o,r),h.calculateMarkerBounds(t.scaleFactor*h.config.baseScaleFactor,_,x)),m+=_*(t=h.getScalingParameters(v,y,o,r)).scaleFactor*h.config.baseScaleFactor,b+=x*t.scaleFactor*h.config.baseScaleFactor):t=h.getScalingParameters(v,y,o,r),h.config.scalingParams=t,a=t.scaleFactor,t.translateX+=m,t.translateY=t.translateY+b+c.top||0,t.sFactor=a*h.config.baseScaleFactor*100/100,t.transformStr=["t",t.translateX,",",t.translateY,"s",a,",",a,",0,0"].join(""),h.config.annotationConfig={id:"Geo",showbelow:0,autoscale:0,grpxshift:t.translateX?t.translateX:0,grpyshift:t.translateY?t.translateY:0,xscale:100*(a?a*h.config.baseScaleFactor:1),yscale:100*(a?a*h.config.baseScaleFactor:1),scaletext:1,options:{useTracker:!0}}}getDataLimits(){let e,t,o,r=this.getDatasets(),a=r.length,n=1/0,i=-1/0;for(o=0;o<a;o++)t=(e=r[o]).getDataLimits(),n=Pt(n,t.min),i=Tt(i,t.max);return{dataMin:n,dataMax:i}}getEntityPaths(e){let t,o={},r=this.config.entities;if(e){for(t in r)o[t]=r[t];return o}return r}checkComplete(){let e=this;e.config.entityFlag&&e.config.entitiesReady&&(e.config.entityFlag=!1,e.config.markersDrawn=!0,e.fireChartInstanceEvent("internal.mapdrawingcomplete",{renderer:e}))}}var Dt=Bt;o.d(t,"Maps",function(){return Dt});t.default={name:"maps",type:"package",requiresFusionCharts:!0,extension:e=>e.addDep(Dt)}}});